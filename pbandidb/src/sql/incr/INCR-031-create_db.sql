/*******************************************************************************
* Copyright Regione Piemonte - 2024
* SPDX-License-Identifier: EUPL-1.2
******************************************************************************/

--00
ALTER TABLE PBANDI_T_REVOCA ADD (ID_CAUSALE_DISIMPEGNO NUMBER(3),
                                 ID_PERIODO NUMBER(8));

ALTER TABLE PBANDI_T_RECUPERO ADD (ID_PERIODO NUMBER(8));
								 
ALTER TABLE PBANDI_T_PAGAMENTO ADD ID_CAUSALE_PAGAMENTO NUMBER(3);
--00
ALTER TABLE PBANDI_D_TIPOLOGIA_AGGIUDICAZ
MODIFY COD_IGRUE_T47 NUMBER(3);
-- 00
ALTER TABLE PBANDI_T_BANDO ADD
(ID_LINEA_DI_INTERVENTO NUMBER (3));
-- PBANDI_D_INDICATORE_QSN
ALTER TABLE PBANDI_D_INDICATORE_QSN
MODIFY COD_IGRUE_T12 NULL;
UPDATE PBANDI_D_INDICATORE_QSN
SET COD_IGRUE_T12 = NULL;
ALTER TABLE PBANDI_D_INDICATORE_QSN
MODIFY COD_IGRUE_T12 VARCHAR2(8);
-- update PBANDI_D_INDICATORE_QSN
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '09'    WHERE ID_INDICATORE_QSN =    1    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '02'    WHERE ID_INDICATORE_QSN =    2    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '03'    WHERE ID_INDICATORE_QSN =    3    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '04'    WHERE ID_INDICATORE_QSN =    4    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '05'    WHERE ID_INDICATORE_QSN =    5    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '06'    WHERE ID_INDICATORE_QSN =    6    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '07'    WHERE ID_INDICATORE_QSN =    7    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '08'    WHERE ID_INDICATORE_QSN =    8    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '01'    WHERE ID_INDICATORE_QSN =    9    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '16'    WHERE ID_INDICATORE_QSN =    10    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '15'    WHERE ID_INDICATORE_QSN =    11    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '17'    WHERE ID_INDICATORE_QSN =    12    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '14'    WHERE ID_INDICATORE_QSN =    13    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '10'    WHERE ID_INDICATORE_QSN =    14    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '12'    WHERE ID_INDICATORE_QSN =    15    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '11'    WHERE ID_INDICATORE_QSN =    16    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '18'    WHERE ID_INDICATORE_QSN =    17    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '13'    WHERE ID_INDICATORE_QSN =    18    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '34'    WHERE ID_INDICATORE_QSN =    19    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '32'    WHERE ID_INDICATORE_QSN =    20    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '31'    WHERE ID_INDICATORE_QSN =    21    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '29'    WHERE ID_INDICATORE_QSN =    22    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '28'    WHERE ID_INDICATORE_QSN =    23    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '27'    WHERE ID_INDICATORE_QSN =    24    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '24'    WHERE ID_INDICATORE_QSN =    25    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '23'    WHERE ID_INDICATORE_QSN =    26    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '22'    WHERE ID_INDICATORE_QSN =    27    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '20'    WHERE ID_INDICATORE_QSN =    28    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '25'    WHERE ID_INDICATORE_QSN =    29    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '33'    WHERE ID_INDICATORE_QSN =    30    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '30'    WHERE ID_INDICATORE_QSN =    31    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '26'    WHERE ID_INDICATORE_QSN =    32    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '21'    WHERE ID_INDICATORE_QSN =    33    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '19'    WHERE ID_INDICATORE_QSN =    34    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '43'    WHERE ID_INDICATORE_QSN =    35    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '38'    WHERE ID_INDICATORE_QSN =    36    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '42'    WHERE ID_INDICATORE_QSN =    37    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '41'    WHERE ID_INDICATORE_QSN =    38    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '35'    WHERE ID_INDICATORE_QSN =    39    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '39'    WHERE ID_INDICATORE_QSN =    40    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '37'    WHERE ID_INDICATORE_QSN =    41    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '36'    WHERE ID_INDICATORE_QSN =    42    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '40'    WHERE ID_INDICATORE_QSN =    43    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '48'    WHERE ID_INDICATORE_QSN =    44    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '49'    WHERE ID_INDICATORE_QSN =    45    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '50'    WHERE ID_INDICATORE_QSN =    46    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '45'    WHERE ID_INDICATORE_QSN =    47    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '46'    WHERE ID_INDICATORE_QSN =    48    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '52'    WHERE ID_INDICATORE_QSN =    49    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '51'    WHERE ID_INDICATORE_QSN =    50    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '44'    WHERE ID_INDICATORE_QSN =    51    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '47'    WHERE ID_INDICATORE_QSN =    52    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '55'    WHERE ID_INDICATORE_QSN =    53    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '54'    WHERE ID_INDICATORE_QSN =    54    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '53'    WHERE ID_INDICATORE_QSN =    55    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '57'    WHERE ID_INDICATORE_QSN =    56    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '56'    WHERE ID_INDICATORE_QSN =    57    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '63'    WHERE ID_INDICATORE_QSN =    58    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '64'    WHERE ID_INDICATORE_QSN =    59    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '65'    WHERE ID_INDICATORE_QSN =    60    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '62'    WHERE ID_INDICATORE_QSN =    61    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '61'    WHERE ID_INDICATORE_QSN =    62    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '60'    WHERE ID_INDICATORE_QSN =    63    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '59'    WHERE ID_INDICATORE_QSN =    64    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '58'    WHERE ID_INDICATORE_QSN =    65    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '66'    WHERE ID_INDICATORE_QSN =    66    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '71'    WHERE ID_INDICATORE_QSN =    67    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '70'    WHERE ID_INDICATORE_QSN =    68    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '69'    WHERE ID_INDICATORE_QSN =    69    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '68'    WHERE ID_INDICATORE_QSN =    70    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '67'    WHERE ID_INDICATORE_QSN =    71    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '72'    WHERE ID_INDICATORE_QSN =    72    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '73'    WHERE ID_INDICATORE_QSN =    73    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '75'    WHERE ID_INDICATORE_QSN =    74    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '74'    WHERE ID_INDICATORE_QSN =    75    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '78'    WHERE ID_INDICATORE_QSN =    76    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '77'    WHERE ID_INDICATORE_QSN =    77    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '76'    WHERE ID_INDICATORE_QSN =    78    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '79'    WHERE ID_INDICATORE_QSN =    79    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '80'    WHERE ID_INDICATORE_QSN =    80    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '84'    WHERE ID_INDICATORE_QSN =    81    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '81'    WHERE ID_INDICATORE_QSN =    82    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '82'    WHERE ID_INDICATORE_QSN =    83    ;
UPDATE PBANDI_D_INDICATORE_QSN SET COD_IGRUE_T12 =     '83'    WHERE ID_INDICATORE_QSN =    84    ;
COMMIT;
--
ALTER TABLE PBANDI_D_INDICATORE_QSN
MODIFY COD_IGRUE_T12 NOT NULL;
--

--
ALTER TABLE PBANDI_D_TEMA_PRIORITARIO 
MODIFY COD_IGRUE_T4 VARCHAR2(3);
--FK
ALTER TABLE PBANDI_T_BANDO ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_43
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
-- 00
ALTER TABLE PBANDI_T_BANDO 
MODIFY ID_INTESA NULL;
--
  
-- PBANDI_R_LINEA_TIPOLOGIA_ATTIV
-- 01.
CREATE TABLE PBANDI_R_LINEA_TIPOLOGIA_ATTIV
(ID_TIPOLOGIA_ATTIVAZIONE NUMBER (3) NOT NULL,
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--
--PK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_ATTIV ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPOL_ATTIV PRIMARY KEY (ID_TIPOLOGIA_ATTIVAZIONE,ID_LINEA_DI_INTERVENTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_ATTIV ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_19
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_ATTIV ADD 
CONSTRAINT FK_PBANDI_D_TIPOLOGIA_ATTIV_02
 FOREIGN KEY (ID_TIPOLOGIA_ATTIVAZIONE)
 REFERENCES PBANDI_D_TIPOLOGIA_ATTIVAZIONE (ID_TIPOLOGIA_ATTIVAZIONE);
--
--
-- PBANDI_R_LINEA_TIPO_ENTE_COMPETENZA
-- 02.
CREATE TABLE PBANDI_R_LINEA_TIPO_ENTE_COMP
(ID_TIPO_ENTE_COMPETENZA NUMBER (3) NOT NULL,
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_TIPO_ENTE_COMP ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPO_ENT_COM PRIMARY KEY (ID_TIPO_ENTE_COMPETENZA,ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_ENTE_COMP ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_20
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_ENTE_COMP ADD 
CONSTRAINT FK_PBANDI_D_TIPO_ENTE_COMPE_02
 FOREIGN KEY (ID_TIPO_ENTE_COMPETENZA)
 REFERENCES PBANDI_D_TIPO_ENTE_COMPETENZA (ID_TIPO_ENTE_COMPETENZA);
--
--
/*
-- PBANDI_R_LINEA_TIPOLOGIA_CIPE
--03.
CREATE TABLE PBANDI_R_LINEA_TIPOLOGIA_CIPE
(ID_TIPOLOGIA_CIPE NUMBER (3)NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_CIPE ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPOL_CIPE PRIMARY KEY (ID_TIPOLOGIA_CIPE,ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_CIPE ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_21
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_CIPE  ADD 
CONSTRAINT FK_PBANDI_D_TIPOLOGIA_CIPE_04
 FOREIGN KEY (ID_TIPOLOGIA_CIPE)
 REFERENCES PBANDI_D_TIPOLOGIA_CIPE (ID_TIPOLOGIA_CIPE);
--
*/
--
/*
-- PBANDI_R_LINEA_NATURA_CIPE
--04.
CREATE TABLE PBANDI_R_LINEA_NATURA_CIPE
(ID_NATURA_CIPE NUMBER (3)NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_NATURA_CIPE ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_NATURA_CIPE PRIMARY KEY (ID_NATURA_CIPE,ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_NATURA_CIPE ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_22
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_NATURA_CIPE  ADD 
CONSTRAINT FK_PBANDI_D_NATURA_CIPE_03
 FOREIGN KEY (ID_NATURA_CIPE)
 REFERENCES PBANDI_D_NATURA_CIPE (ID_NATURA_CIPE);
--
*/
--
-- PBANDI_R_LINEA_TIPO_AIUTO
--05.
CREATE TABLE PBANDI_R_LINEA_TIPO_AIUTO
(ID_TIPO_AIUTO NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_TIPO_AIUTO ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPO_AIUTO PRIMARY KEY (ID_TIPO_AIUTO, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_AIUTO ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_23
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_AIUTO  ADD 
CONSTRAINT FK_PBANDI_D_TIPO_AIUTO_05
 FOREIGN KEY (ID_TIPO_AIUTO)
 REFERENCES PBANDI_D_TIPO_AIUTO (ID_TIPO_AIUTO);
--
--

-- PBANDI_R_LINEA_DIMENSIONE_TER
--06.
CREATE TABLE PBANDI_R_LINEA_DIMENSIONE_TER
(ID_DIMENSIONE_TERRITOR NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_DIMENSIONE_TER ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_DIM_TER PRIMARY KEY (ID_DIMENSIONE_TERRITOR, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_DIMENSIONE_TER ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_24
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_DIMENSIONE_TER  ADD 
CONSTRAINT FK_PBANDI_D_DIMENSIONE_TERR_04
 FOREIGN KEY (ID_DIMENSIONE_TERRITOR)
 REFERENCES PBANDI_D_DIMENSIONE_TERRITOR (ID_DIMENSIONE_TERRITOR);
--
--
-- PBANDI_R_LINEA_ATTIVITA_ECONOM
--07.
CREATE TABLE PBANDI_R_LINEA_ATTIVITA_ECONOM
(ID_ATTIVITA_ECONOMICA NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_ATTIVITA_ECONOM ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_ATT_ECONOM PRIMARY KEY (ID_ATTIVITA_ECONOMICA, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_ATTIVITA_ECONOM ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_25
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_ATTIVITA_ECONOM  ADD 
CONSTRAINT FK_PBANDI_D_ATTIVITA_ECONOM_02
 FOREIGN KEY (ID_ATTIVITA_ECONOMICA)
 REFERENCES PBANDI_D_ATTIVITA_ECONOMICA (ID_ATTIVITA_ECONOMICA);
--
--
-- PBANDI_R_LINEA_FORMA_GIURIDICA
--08.
CREATE TABLE PBANDI_R_LINEA_FORMA_GIURIDICA
(ID_FORMA_GIURIDICA NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_FORMA_GIURIDICA ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_FORMA_GIUR PRIMARY KEY (ID_FORMA_GIURIDICA, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_FORMA_GIURIDICA ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_26
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_FORMA_GIURIDICA  ADD 
CONSTRAINT FK_PBANDI_D_FORMA_GIURIDICA_06
 FOREIGN KEY (ID_FORMA_GIURIDICA)
 REFERENCES PBANDI_D_FORMA_GIURIDICA (ID_FORMA_GIURIDICA);
--
--

-- PBANDI_R_LINEA_TIPOLOGIA_AGG
--09.
CREATE TABLE PBANDI_R_LINEA_TIPOLOGIA_AGG
(ID_TIPOLOGIA_AGGIUDICAZ NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_AGG ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPOL_AGG PRIMARY KEY (ID_TIPOLOGIA_AGGIUDICAZ, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_AGG ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_27
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPOLOGIA_AGG  ADD 
CONSTRAINT FK_PBANDI_D_TIPOLOGIA_AGG_03
 FOREIGN KEY (ID_TIPOLOGIA_AGGIUDICAZ)
 REFERENCES PBANDI_D_TIPOLOGIA_AGGIUDICAZ (ID_TIPOLOGIA_AGGIUDICAZ);
--
--

-- PBANDI_R_LINEA_RUOLO_ENTE_COMP
--10.
CREATE TABLE PBANDI_R_LINEA_RUOLO_ENTE_COMP (
ID_RUOLO_ENTE_COMPETENZA NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_RUOLO_ENTE_COMP ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_RU_ENTE_COMP PRIMARY KEY (ID_RUOLO_ENTE_COMPETENZA, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_RUOLO_ENTE_COMP ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_28
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_RUOLO_ENTE_COMP  ADD 
CONSTRAINT FK_PBANDI_D_RUOLO_ENTE_COMP_06
 FOREIGN KEY (ID_RUOLO_ENTE_COMPETENZA)
 REFERENCES PBANDI_D_RUOLO_ENTE_COMPETENZA (ID_RUOLO_ENTE_COMPETENZA);
--
--
-- PBANDI_R_LINEA_SETTORE_ATT
--11.
CREATE TABLE PBANDI_R_LINEA_SETTORE_ATT
(
ID_SETTORE_ATTIVITA  NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_SETTORE_ATT ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_SETTORE_ATT PRIMARY KEY (ID_SETTORE_ATTIVITA, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_SETTORE_ATT ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_29
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_SETTORE_ATT  ADD 
CONSTRAINT FK_PBANDI_D_SETTORE_ATTIV_02
 FOREIGN KEY (ID_SETTORE_ATTIVITA)
 REFERENCES PBANDI_D_SETTORE_ATTIVITA (ID_SETTORE_ATTIVITA);
--
--
-- PBANDI_R_LINEA_ATTIVITA_ATECO
--12.
CREATE TABLE PBANDI_R_LINEA_ATTIVITA_ATECO
(
ID_ATTIVITA_ATECO NUMBER (4) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_ATTIVITA_ATECO ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_ATT_ATECO PRIMARY KEY (ID_ATTIVITA_ATECO, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_ATTIVITA_ATECO ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_30
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_ATTIVITA_ATECO  ADD 
CONSTRAINT FK_PBANDI_D_ATTIVITA_ATECO_06
 FOREIGN KEY (ID_ATTIVITA_ATECO)
 REFERENCES PBANDI_D_ATTIVITA_ATECO (ID_ATTIVITA_ATECO);
--
--

-- PBANDI_R_LINEA_VOC_DI_SP_MONIT
--13.
CREATE TABLE PBANDI_R_LINEA_VOC_DI_SP_MONIT
(
ID_VOCE_DI_SPESA_MONIT NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE PBANDI_R_LINEA_VOC_DI_SP_MONIT ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LIN_VOC_DI_SP_MON PRIMARY KEY (ID_VOCE_DI_SPESA_MONIT, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_VOC_DI_SP_MONIT ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_31
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_VOC_DI_SP_MONIT  ADD 
CONSTRAINT FK_PBANDI_D_VOCE_SPES_MONIT_02
 FOREIGN KEY (ID_VOCE_DI_SPESA_MONIT)
 REFERENCES PBANDI_D_VOCE_DI_SPESA_MONIT (ID_VOCE_DI_SPESA_MONIT);
--
--
/*
-- PBANDI_R_LINEA_TIPO_OPERAZIONE
--14.
CREATE TABLE PBANDI_R_LINEA_TIPO_OPERAZIONE
(
ID_TIPO_OPERAZIONE NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE  PBANDI_R_LINEA_TIPO_OPERAZIONE ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPO_OPERAZ PRIMARY KEY (ID_TIPO_OPERAZIONE, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_OPERAZIONE ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_32
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_OPERAZIONE  ADD 
CONSTRAINT FK_PBANDI_D_TIPO_OPERAZIONE_07
 FOREIGN KEY (ID_TIPO_OPERAZIONE)
 REFERENCES PBANDI_D_TIPO_OPERAZIONE (ID_TIPO_OPERAZIONE);
--
*/
--
-- PBANDI_R_LINEA_FASE_MONIT
--15.
CREATE TABLE PBANDI_R_LINEA_FASE_MONIT
(
ID_FASE_MONIT NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);

--PK
ALTER TABLE  PBANDI_R_LINEA_FASE_MONIT ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_FASE_MONIT PRIMARY KEY (ID_FASE_MONIT, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_FASE_MONIT ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_33
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_FASE_MONIT  ADD 
CONSTRAINT FK_PBANDI_D_FASE_MONIT_04
 FOREIGN KEY (ID_FASE_MONIT)
 REFERENCES PBANDI_D_FASE_MONIT (ID_FASE_MONIT);
--
--
-- PBANDI_R_LINEA_ITER
--16.
CREATE TABLE PBANDI_R_LINEA_ITER
(
ID_ITER NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_ITER ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_ITER PRIMARY KEY (ID_ITER, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_ITER ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_34
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_ITER  ADD 
CONSTRAINT FK_PBANDI_D_ITER_02
 FOREIGN KEY (ID_ITER)
 REFERENCES PBANDI_D_ITER (ID_ITER);
--
--
-- PBANDI_R_LINEA_STATO_PROGETTO
--17.
CREATE TABLE PBANDI_R_LINEA_STATO_PROGETTO
(
ID_STATO_PROGETTO NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_STATO_PROGETTO ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_STATO_PROG PRIMARY KEY (ID_STATO_PROGETTO, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_STATO_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_35
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_STATO_PROGETTO  ADD 
CONSTRAINT FK_PBANDI_D_STATO_PROGETTO_03
 FOREIGN KEY (ID_STATO_PROGETTO)
 REFERENCES PBANDI_D_STATO_PROGETTO (ID_STATO_PROGETTO);
--
--
-- PBANDI_R_LINEA_TIPOL_ATT
--18.
CREATE TABLE PBANDI_R_LINEA_TIPOL_ATT
(
ID_TIPOLOGIA_ATTIVAZIONE NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_TIPOL_ATT ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPOL_ATT PRIMARY KEY (ID_TIPOLOGIA_ATTIVAZIONE, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPOL_ATT ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_36
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPOL_ATT  ADD 
CONSTRAINT FK_PBANDI_D_TIPOLOGIA_ATTIV_03
 FOREIGN KEY (ID_TIPOLOGIA_ATTIVAZIONE)
 REFERENCES PBANDI_D_TIPOLOGIA_ATTIVAZIONE (ID_TIPOLOGIA_ATTIVAZIONE);
--
--
-- PBANDI_R_LINEA_TEMA_PRIOR
--19.
CREATE TABLE PBANDI_R_LINEA_TEMA_PRIOR
(
ID_TEMA_PRIORITARIO NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_TEMA_PRIOR ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TEMA_PRIOR PRIMARY KEY (ID_TEMA_PRIORITARIO, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TEMA_PRIOR ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_37
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TEMA_PRIOR  ADD 
CONSTRAINT FK_PBANDI_D_TEMA_PRIORITAR_05
 FOREIGN KEY (ID_TEMA_PRIORITARIO)
 REFERENCES PBANDI_D_TEMA_PRIORITARIO (ID_TEMA_PRIORITARIO);
--
--
--
-- PBANDI_R_LINEA_INDICATORE_QSN
--20.
CREATE TABLE PBANDI_R_LINEA_INDICATORE_QSN
(
ID_INDICATORE_QSN NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_INDICATORE_QSN ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_INDIC_QSN PRIMARY KEY (ID_INDICATORE_QSN, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_INDICATORE_QSN ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_38
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_INDICATORE_QSN  ADD 
CONSTRAINT FK_PBANDI_D_INDICATORE_QSN_04
 FOREIGN KEY (ID_INDICATORE_QSN)
 REFERENCES PBANDI_D_INDICATORE_QSN (ID_INDICATORE_QSN);
 --
 --
-- 21.
-- PBANDI_R_LINEA_STRUMENTO_ATT
CREATE TABLE PBANDI_R_LINEA_STRUMENTO_ATT
(
ID_STRUMENTO_ATTUATIVO NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_STRUMENTO_ATT ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_STRUM_ATT PRIMARY KEY (ID_STRUMENTO_ATTUATIVO, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_STRUMENTO_ATT ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_40
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_STRUMENTO_ATT  ADD 
CONSTRAINT FK_PBANDI_D_STRUMENTO_ATTUA_04
 FOREIGN KEY (ID_STRUMENTO_ATTUATIVO)
 REFERENCES PBANDI_D_STRUMENTO_ATTUATIVO (ID_STRUMENTO_ATTUATIVO);
 
--
-- PBANDI_D_TIPO_LOCALIZZAZIONE
-- 22.
CREATE TABLE PBANDI_D_TIPO_LOCALIZZAZIONE
(
ID_TIPO_LOCALIZZAZIONE      NUMBER(3)         NOT NULL,
DESC_BREVE_TIPO_LOCAL      VARCHAR2(20)     NOT NULL,
DESC_TIPO_LOCALIZZAZIONE  VARCHAR2(255)     NOT NULL,
DT_INIZIO_VALIDITA        DATE              NOT NULL,
DT_FINE_VALIDITA          DATE,
TC10 VARCHAR2(20)
);

--PK
ALTER TABLE PBANDI_D_TIPO_LOCALIZZAZIONE ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_TIPO_LOCAL PRIMARY KEY (ID_TIPO_LOCALIZZAZIONE)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
 --
 --
-- PBANDI_D_CLASSIFICAZIONE_MET
-- 23.
CREATE TABLE PBANDI_D_CLASSIFICAZIONE_MET
(ID_CLASSIFICAZIONE_MET    NUMBER(3)         NOT NULL,
 DESC_BREVE_CLASS_MET    VARCHAR2(20)     NOT NULL,
 DESC_CLASS_MET            VARCHAR2(255)     NOT NULL,
 DT_INIZIO_VALIDITA      DATE              NOT NULL,
 DT_FINE_VALIDITA        DATE,
 TC12_4 VARCHAR2(20)
);

--PK
ALTER TABLE PBANDI_D_CLASSIFICAZIONE_MET ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_CLASSIF_MET PRIMARY KEY (ID_CLASSIFICAZIONE_MET)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--
--
/*
-- PBANDI_D_CLASSIFICAZIONE_DTS
-- 24.
CREATE TABLE PBANDI_D_CLASSIFICAZIONE_DTS
(ID_CLASSIFICAZIONE_DTS       NUMBER(3)         NOT NULL,
 DESC_BREVE_CLASS_DTS       VARCHAR2(20)     NOT NULL,
 DESC_CLASS_DTS               VARCHAR2(255)     NOT NULL,
 DT_INIZIO_VALIDITA         DATE              NOT NULL,
 DT_FINE_VALIDITA           DATE    
);

--PK
ALTER TABLE PBANDI_D_CLASSIFICAZIONE_DTS ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_CLASSIF_DTS PRIMARY KEY (ID_CLASSIFICAZIONE_DTS)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--
*/
-- PBANDI_D_MOTIVO_ASSENZA_CIG
-- 25.
CREATE TABLE PBANDI_D_MOTIVO_ASSENZA_CIG
(ID_MOTIVO_ASSENZA_CIG	 NUMBER(3)     	NOT NULL,
 DESC_BREVE_MOTIVO_ASSENZA_CIG VARCHAR2(20) 	NOT NULL,
 DESC_MOTIVO_ASSENZA_CIG VARCHAR2(255) 	NOT NULL,
 DT_INIZIO_VALIDITA  	 DATE          	NOT NULL,
 DT_FINE_VALIDITA	     DATE,
 TC22 VARCHAR2(20)
);
--PK
ALTER TABLE PBANDI_D_MOTIVO_ASSENZA_CIG ADD  
 ( 
  CONSTRAINT PK_D_MOTIVO_ASSENZA_CIG PRIMARY KEY (ID_MOTIVO_ASSENZA_CIG)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 ); 
--
--
-- PBANDI_D_TIPO_PROCEDURA_ORIG
-- 26.
CREATE TABLE PBANDI_D_TIPO_PROCEDURA_ORIG
(ID_TIPO_PROCEDURA_ORIG            NUMBER(3)         NOT NULL,
 DESC_BREVE_TIPO_PROCEDURA_ORIG    VARCHAR2(20)     NOT NULL,
 DESC_TIPO_PROCEDURA_ORIG          VARCHAR2(255)     NOT NULL,
 DT_INIZIO_VALIDITA                DATE              NOT NULL,
 DT_FINE_VALIDITA                  DATE    
);

--PK
ALTER TABLE PBANDI_D_TIPO_PROCEDURA_ORIG ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_TIPO_PROC_ORIG PRIMARY KEY (ID_TIPO_PROCEDURA_ORIG)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );

--
-- PBANDI_D_TIPO_PERCETTORE
-- 27.
CREATE TABLE PBANDI_D_TIPO_PERCETTORE
(ID_TIPO_PERCETTORE            NUMBER(3) NOT NULL,
 DESC_BREVE_TIPO_PERCETTORE    VARCHAR2(20) NOT NULL,
 DESC_TIPO_PERCETTORE        VARCHAR2(255) NOT NULL,
 DT_INIZIO_VALIDITA          DATE  NOT NULL,
 DT_FINE_VALIDITA            DATE,
 TC40 VARCHAR2(20)
);
--PK
ALTER TABLE PBANDI_D_TIPO_PERCETTORE ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_TIPO_PERCETTORE PRIMARY KEY (ID_TIPO_PERCETTORE)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--
-- PBANDI_D_CAUSALE_DISIMPEGNO
-- 28.
CREATE TABLE PBANDI_D_CAUSALE_DISIMPEGNO
(ID_CAUSALE_DISIMPEGNO            NUMBER(3)         NOT NULL,
 DESC_BREVE_CAUSALE_DISIMPEGNO    VARCHAR2(20)     NOT NULL,
 DESC_CAUSALE_DISIMPEGNO        VARCHAR2(255)     NOT NULL,
 DT_INIZIO_VALIDITA              DATE              NOT NULL,
 DT_FINE_VALIDITA                DATE,
 TC38 VARCHAR2(20)
);

--PK
ALTER TABLE PBANDI_D_CAUSALE_DISIMPEGNO ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_CAUSALE_DISIMPEGNO PRIMARY KEY (ID_CAUSALE_DISIMPEGNO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--
--
-- PBANDI_D_CAUSALE_TRASFERIMENTO
-- 29
CREATE TABLE PBANDI_D_CAUSALE_TRASFERIMENTO
(ID_CAUSALE_TRASFERIMENTO    NUMBER(3)         NOT NULL,
 DESC_BREVE_CAUSALE_TRASFER    VARCHAR2(20)     NOT NULL,
 DESC_CAUSALE_TRASFER    VARCHAR2(255)     NOT NULL,
 DT_INIZIO_VALIDITA      DATE              NOT NULL,
 DT_FINE_VALIDITA    DATE,
 TC49 VARCHAR2(20) 
);

--PK
ALTER TABLE PBANDI_D_CAUSALE_TRASFERIMENTO ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_CAUSALE_TRASF PRIMARY KEY (ID_CAUSALE_TRASFERIMENTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
-- 30.
-- PBANDI_R_LINEA_TIPO_LOCAL
CREATE TABLE PBANDI_R_LINEA_TIPO_LOCAL
(
ID_TIPO_LOCALIZZAZIONE NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_TIPO_LOCAL ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPO_LOCAL PRIMARY KEY (ID_TIPO_LOCALIZZAZIONE, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_LOCAL ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_41
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_LOCAL  ADD 
CONSTRAINT FK_PBANDI_D_TIPO_LOCAL_01
 FOREIGN KEY (ID_TIPO_LOCALIZZAZIONE)
 REFERENCES PBANDI_D_TIPO_LOCALIZZAZIONE (ID_TIPO_LOCALIZZAZIONE);
--
--
-- 31.
-- PBANDI_R_LINEA_CLASSIF_MET
CREATE TABLE PBANDI_R_LINEA_CLASSIF_MET
(
ID_CLASSIFICAZIONE_MET NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_CLASSIF_MET ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_CLASSIF_MET PRIMARY KEY (ID_CLASSIFICAZIONE_MET, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_CLASSIF_MET ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_42
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_CLASSIF_MET  ADD 
CONSTRAINT FK_PBANDI_D_CLASSIF_MET_01
 FOREIGN KEY (ID_CLASSIFICAZIONE_MET)
 REFERENCES PBANDI_D_CLASSIFICAZIONE_MET (ID_CLASSIFICAZIONE_MET);
 
--
--
/*
-- 32.
-- PBANDI_R_LINEA_CLASSIF_DTS
CREATE TABLE PBANDI_R_LINEA_CLASSIF_DTS
(
ID_CLASSIFICAZIONE_DTS NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_CLASSIF_DTS ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_CLASSIF_DTS PRIMARY KEY (ID_CLASSIFICAZIONE_DTS, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_CLASSIF_DTS ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_43
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_CLASSIF_DTS  ADD 
CONSTRAINT FK_PBANDI_D_CLASSIF_DTS_01
 FOREIGN KEY (ID_CLASSIFICAZIONE_DTS)
 REFERENCES PBANDI_D_CLASSIFICAZIONE_DTS (ID_CLASSIFICAZIONE_DTS);
--
--
*/
-- 33.
-- PBANDI_R_LINEA_MOT_ASSENZA_CIG
CREATE TABLE PBANDI_R_LINEA_MOT_ASSENZA_CIG
(
ID_MOTIVO_ASSENZA_CIG NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_MOT_ASSENZA_CIG ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_MOT_ASS_CIG PRIMARY KEY (ID_MOTIVO_ASSENZA_CIG, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_MOT_ASSENZA_CIG ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_44
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_MOT_ASSENZA_CIG  ADD 
CONSTRAINT FK_PBANDI_D_MOTIVO_ASS_CIG_01
 FOREIGN KEY (ID_MOTIVO_ASSENZA_CIG)
 REFERENCES PBANDI_D_MOTIVO_ASSENZA_CIG (ID_MOTIVO_ASSENZA_CIG);
 --
 --
 -- 34.
-- PBANDI_R_LINEA_CAUSALE_TRASF
CREATE TABLE PBANDI_R_LINEA_CAUSALE_TRASF
(
ID_CAUSALE_TRASFERIMENTO NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_CAUSALE_TRASF ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_CAUS_TRASF PRIMARY KEY (ID_CAUSALE_TRASFERIMENTO, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_CAUSALE_TRASF ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_45
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_CAUSALE_TRASF  ADD 
CONSTRAINT FK_PBANDI_D_CAUS_TRASF_01
 FOREIGN KEY (ID_CAUSALE_TRASFERIMENTO)
 REFERENCES PBANDI_D_CAUSALE_TRASFERIMENTO (ID_CAUSALE_TRASFERIMENTO);
--
--
-- 35.
-- PBANDI_R_LINEA_PROCEDURA_ORIG
CREATE TABLE PBANDI_R_LINEA_PROCEDURA_ORIG
(
ID_TIPO_PROCEDURA_ORIG NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_PROCEDURA_ORIG ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_PROC_ORIG PRIMARY KEY (ID_TIPO_PROCEDURA_ORIG, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_PROCEDURA_ORIG ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_46
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_PROCEDURA_ORIG  ADD 
CONSTRAINT FK_PBANDI_D_TIPO_PROC_ORIG_01
 FOREIGN KEY (ID_TIPO_PROCEDURA_ORIG)
 REFERENCES PBANDI_D_TIPO_PROCEDURA_ORIG (ID_TIPO_PROCEDURA_ORIG);
--
--
/*
-- 36.
-- PBANDI_R_LINEA_TIPO_PERCETTORE
CREATE TABLE PBANDI_R_LINEA_TIPO_PERCETTORE
(
ID_TIPO_PERCETTORE NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_TIPO_PERCETTORE ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPO_PERCET PRIMARY KEY (ID_TIPO_PERCETTORE, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_PERCETTORE ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_47
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_PERCETTORE  ADD 
CONSTRAINT FK_PBANDI_D_TIPO_PERCET_01
 FOREIGN KEY (ID_TIPO_PERCETTORE)
 REFERENCES PBANDI_D_TIPO_PERCETTORE (ID_TIPO_PERCETTORE);
--
--
*/
-- 37.
--  PBANDI_R_LINEA_CAUS_DISIMPEGNO
CREATE TABLE PBANDI_R_LINEA_CAUS_DISIMPEGNO
(
ID_CAUSALE_DISIMPEGNO NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE  PBANDI_R_LINEA_CAUS_DISIMPEGNO ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_CAUS_DISIMP PRIMARY KEY (ID_CAUSALE_DISIMPEGNO, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_CAUS_DISIMPEGNO ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_48
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_CAUS_DISIMPEGNO  ADD 
CONSTRAINT FK_PBANDI_D_CAUS_DISIMP_01
 FOREIGN KEY (ID_CAUSALE_DISIMPEGNO)
 REFERENCES PBANDI_D_CAUSALE_DISIMPEGNO (ID_CAUSALE_DISIMPEGNO);
--
-- PBANDI_T_REVOCA
ALTER TABLE PBANDI_T_REVOCA  ADD (
CONSTRAINT FK_PBANDI_D_CAUS_DISIMP_02
 FOREIGN KEY (ID_CAUSALE_DISIMPEGNO)
 REFERENCES PBANDI_D_CAUSALE_DISIMPEGNO (ID_CAUSALE_DISIMPEGNO),
 CONSTRAINT FK_PBANDI_T_PERIODO_03
 FOREIGN KEY (ID_PERIODO)
 REFERENCES PBANDI_T_PERIODO (ID_PERIODO));
 
--INDEX
CREATE INDEX IE1_PBANDI_T_REVOCA ON PBANDI_T_REVOCA (ID_CAUSALE_DISIMPEGNO)  TABLESPACE PBANDI_IDX;
CREATE INDEX IE2_PBANDI_T_REVOCA ON PBANDI_T_REVOCA (ID_PERIODO)  TABLESPACE PBANDI_IDX;
 
--
-- PBANDI_T_RECUPERO
ALTER TABLE PBANDI_T_RECUPERO  ADD (
 CONSTRAINT FK_PBANDI_T_PERIODO_04
 FOREIGN KEY (ID_PERIODO)
 REFERENCES PBANDI_T_PERIODO (ID_PERIODO));
 
--INDEX
CREATE INDEX IE1_PBANDI_T_RECUPERO ON PBANDI_T_RECUPERO (ID_PERIODO)  TABLESPACE PBANDI_IDX;
 

--
-- 38. PBANDI_D_CAUSALE_PAGAMENTO

CREATE TABLE PBANDI_D_CAUSALE_PAGAMENTO
(        
ID_CAUSALE_PAGAMENTO NUMBER(3) NOT NULL,
DESC_BREVE_CAUSALE_PAGAMENTO   VARCHAR2(20) NOT NULL,
DESC_CAUSALE_PAGAMENTO    VARCHAR2(255) NOT NULL,
DT_INIZIO_VALIDITA DATE NOT NULL,
DT_FINE_VALIDITA DATE,
TC39 VARCHAR2(20),
TIPO_PAGAMENTO VARCHAR2(1)
);
--
--PK
ALTER TABLE PBANDI_D_CAUSALE_PAGAMENTO ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_CAUSALE_PAGAMENTO PRIMARY KEY (ID_CAUSALE_PAGAMENTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
 --
 --
-- 39.PBANDI_D_GR_VULNERABILI_PROG
CREATE TABLE PBANDI_D_GR_VULNERABILI_PROG
(        
ID_GR_VULNERABILI_PROG NUMBER(3) NOT NULL,
DESC_BREVE_GR_VULNERABILI_PROG  VARCHAR2(20)  NOT NULL,
DESC_GR_VULNERABILI_PROG    VARCHAR2(255) NOT NULL,
DT_INIZIO_VALIDITA DATE NOT NULL,
DT_FINE_VALIDITA    DATE,
TC13 VARCHAR2(20)
);
--PK
ALTER TABLE PBANDI_D_GR_VULNERABILI_PROG ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_GR_VULNE_PROG PRIMARY KEY (ID_GR_VULNERABILI_PROG)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--
--

-- 40. PBANDI_R_LINEA_CAUS_PAGAMENTO
--
CREATE TABLE PBANDI_R_LINEA_CAUS_PAGAMENTO
(
ID_CAUSALE_PAGAMENTO NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE  PBANDI_R_LINEA_CAUS_PAGAMENTO ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_CAUS_PAG PRIMARY KEY (ID_CAUSALE_PAGAMENTO, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_CAUS_PAGAMENTO ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_49
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_CAUS_PAGAMENTO  ADD 
CONSTRAINT FK_PBANDI_D_CAUS_PAGAMENTO_01
 FOREIGN KEY (ID_CAUSALE_PAGAMENTO)
 REFERENCES PBANDI_D_CAUSALE_PAGAMENTO (ID_CAUSALE_PAGAMENTO);
 
-- PBANDI_T_PAGAMENTO
-- FK
ALTER TABLE PBANDI_T_PAGAMENTO  ADD 
CONSTRAINT FK_PBANDI_D_CAUS_PAGAMENTO_02
 FOREIGN KEY (ID_CAUSALE_PAGAMENTO)
 REFERENCES PBANDI_D_CAUSALE_PAGAMENTO (ID_CAUSALE_PAGAMENTO);
 
 -- 41. PBANDI_R_LINEA_GR_VULNE_PROG
 --  
 CREATE TABLE PBANDI_R_LINEA_GR_VULNE_PROG
(
ID_GR_VULNERABILI_PROG NUMBER (3) NOT NULL,            
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE  PBANDI_R_LINEA_GR_VULNE_PROG ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_GR_VUL_PROG PRIMARY KEY (ID_GR_VULNERABILI_PROG, ID_LINEA_DI_INTERVENTO )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE  PBANDI_R_LINEA_GR_VULNE_PROG ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_50
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_GR_VULNE_PROG  ADD 
CONSTRAINT FK_PBANDI_D_GR_VULNE_PROG_01
 FOREIGN KEY (ID_GR_VULNERABILI_PROG)
 REFERENCES PBANDI_D_GR_VULNERABILI_PROG (ID_GR_VULNERABILI_PROG);
--
--

CREATE TABLE PBANDI_R_REVOCA_IRREG
(ID_REVOCA NUMBER(8),
 ID_IRREGOLARITA NUMBER(8),
 QUOTA_IRREG  NUMBER(17,2)
);

COMMENT ON TABLE PBANDI_R_REVOCA_IRREG IS 'Quota revoca dovuta a irregolarità';
COMMENT ON COLUMN PBANDI_R_REVOCA_IRREG.QUOTA_IRREG IS 'Quota dovuta a irregolarità';

ALTER TABLE  PBANDI_R_REVOCA_IRREG ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_REVOCA_IRREG PRIMARY KEY (ID_REVOCA, ID_IRREGOLARITA )
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );

 ALTER TABLE PBANDI_R_REVOCA_IRREG  ADD (
  CONSTRAINT FK_PBANDI_T_REVOCA_03
 FOREIGN KEY (ID_REVOCA)
 REFERENCES PBANDI_T_REVOCA (ID_REVOCA),
 CONSTRAINT FK_PBANDI_T_IRREGOLARITA_02
 FOREIGN KEY (ID_IRREGOLARITA)
 REFERENCES PBANDI_T_IRREGOLARITA (ID_IRREGOLARITA)
 )
 ;
 
-- Anno contabile
ALTER TABLE PBANDI_T_PERIODO
 ADD (DT_INIZIO_CONTABILE DATE,
      DT_FINE_CONTABILE DATE);

COMMENT ON COLUMN PBANDI_T_PERIODO.DT_INIZIO_CONTABILE IS 'Data inizio anno contabile. Valorizzata se tipo periodo=3 (Anno contabile)';
COMMENT ON COLUMN PBANDI_T_PERIODO.DT_FINE_CONTABILE  IS 'Data fine anno contabile. Valorizzata se tipo periodo=3 (Anno contabile)';
 
--INDICI
CREATE INDEX IE1_PBANDI_R_REVOCA_IRREG ON PBANDI_R_REVOCA_IRREG (ID_IRREGOLARITA)  TABLESPACE PBANDI_IDX;


--  42. PBANDI_R_LINEA_PROG_COMPLESSO
CREATE TABLE PBANDI_R_LINEA_PROG_COMPLESSO
(ID_PROGETTO_COMPLESSO NUMBER (3) NOT NULL,
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--
--PK
ALTER TABLE PBANDI_R_LINEA_PROG_COMPLESSO ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_PROG_COMPL PRIMARY KEY (ID_PROGETTO_COMPLESSO,ID_LINEA_DI_INTERVENTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_PROG_COMPLESSO ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_51
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_PROG_COMPLESSO ADD 
CONSTRAINT FK_PBANDI_D_PROG_COMPLESSO_03
 FOREIGN KEY (ID_PROGETTO_COMPLESSO)
 REFERENCES PBANDI_D_PROGETTO_COMPLESSO  (ID_PROGETTO_COMPLESSO);
--
--
-- 43. PBANDI_D_LIVELLO_ISTITUZIONE
CREATE TABLE PBANDI_D_LIVELLO_ISTITUZIONE
(ID_LIVELLO_ISTITUZIONE  NUMBER(3) NOT NULL,
DESC_BREVE_LIVELLO_ISTITUZIONE  VARCHAR2(20) NOT NULL,
DESC_LIVELLO_ISTITUZIONE  VARCHAR2(255) NOT NULL,
DT_INIZIO_VALIDITA DATE  NOT NULL,
DT_FINE_VALIDITA DATE,     
TC09    VARCHAR2(20)       
);

--PK
ALTER TABLE PBANDI_D_LIVELLO_ISTITUZIONE ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_LIVELLO_ISTITUZ PRIMARY KEY (ID_LIVELLO_ISTITUZIONE)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--
--  44. PBANDI_R_LINEA_LIVELLO_ISTITUZ
CREATE TABLE PBANDI_R_LINEA_LIVELLO_ISTITUZ
(ID_LIVELLO_ISTITUZIONE NUMBER (3) NOT NULL,
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--
--PK
ALTER TABLE PBANDI_R_LINEA_LIVELLO_ISTITUZ ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_LIV_ISTITUZ PRIMARY KEY (ID_LIVELLO_ISTITUZIONE,ID_LINEA_DI_INTERVENTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_LIVELLO_ISTITUZ ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_52
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_LIVELLO_ISTITUZ ADD 
CONSTRAINT FK_PBANDI_D_LIV_ISTITUZIONE_01
 FOREIGN KEY (ID_LIVELLO_ISTITUZIONE)
 REFERENCES PBANDI_D_LIVELLO_ISTITUZIONE  (ID_LIVELLO_ISTITUZIONE);
 
--  45. PBANDI_R_LINEA_TIPO_INDICATORE

CREATE TABLE PBANDI_R_LINEA_TIPO_INDICATORE
(ID_TIPO_INDICATORE NUMBER (3) NOT NULL,
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--
--PK
ALTER TABLE PBANDI_R_LINEA_TIPO_INDICATORE ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_TIPO_INDIC PRIMARY KEY (ID_TIPO_INDICATORE,ID_LINEA_DI_INTERVENTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_INDICATORE ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_53
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_TIPO_INDICATORE ADD 
CONSTRAINT FK_PBANDI_D_TIPO_INDICATORE_02
 FOREIGN KEY (ID_TIPO_INDICATORE)
 REFERENCES PBANDI_D_TIPO_INDICATORE  (ID_TIPO_INDICATORE);
/*
--  46. PBANDI_R_LINEA_INDICATORI
CREATE TABLE PBANDI_R_LINEA_INDICATORI
(ID_INDICATORI NUMBER (3) NOT NULL,
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--
--PK
ALTER TABLE PBANDI_R_LINEA_INDICATORI ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_INDICATORI PRIMARY KEY (ID_INDICATORI,ID_LINEA_DI_INTERVENTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_LINEA_INDICATORI ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_54
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_INDICATORI ADD 
CONSTRAINT FK_PBANDI_D_INDICATORI_04
 FOREIGN KEY (ID_INDICATORI)
 REFERENCES PBANDI_D_INDICATORI  (ID_INDICATORI);
*/
-- PBANDI_R_BANDO_LINEA_INTERVENT
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD
(ID_TIPO_LOCALIZZAZIONE  NUMBER (3),
 ID_LIVELLO_ISTITUZIONE   NUMBER (3), 
 ID_PROGETTO_COMPLESSO NUMBER (3)       
);  

-- FK
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD 
CONSTRAINT FK_PBANDI_D_TIPO_LOCAL_02
 FOREIGN KEY (ID_TIPO_LOCALIZZAZIONE)
 REFERENCES PBANDI_D_TIPO_LOCALIZZAZIONE  (ID_TIPO_LOCALIZZAZIONE);
--
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD 
CONSTRAINT FK_PBANDI_D_LIV_ISTITUZIONE_02
 FOREIGN KEY (ID_LIVELLO_ISTITUZIONE)
 REFERENCES PBANDI_D_LIVELLO_ISTITUZIONE  (ID_LIVELLO_ISTITUZIONE);
--
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD 
CONSTRAINT FK_PBANDI_D_PROG_COMPLESSO_04
 FOREIGN KEY (ID_PROGETTO_COMPLESSO)
 REFERENCES PBANDI_D_PROGETTO_COMPLESSO  (ID_PROGETTO_COMPLESSO);
--
--INDEX
CREATE INDEX IE3_PBANDI_R_BANDO_LIN_INTERV ON PBANDI_R_BANDO_LINEA_INTERVENT (ID_TIPO_LOCALIZZAZIONE)   TABLESPACE PBANDI_IDX;
CREATE INDEX IE4_PBANDI_R_BANDO_LIN_INTERV ON PBANDI_R_BANDO_LINEA_INTERVENT (ID_LIVELLO_ISTITUZIONE)   TABLESPACE PBANDI_IDX;
CREATE INDEX IE5_PBANDI_R_BANDO_LIN_INTERV ON PBANDI_R_BANDO_LINEA_INTERVENT (ID_PROGETTO_COMPLESSO)   TABLESPACE PBANDI_IDX;
--

-- PBANDI_D_FORMA_GIURIDICA
ALTER TABLE PBANDI_D_FORMA_GIURIDICA ADD
(DIVISIONE VARCHAR2(255),
 SEZIONE VARCHAR2(255),
 FLAG_PRIVATO VARCHAR2(1)
);
-- PBANDI_T_FORNITORE
ALTER TABLE PBANDI_T_FORNITORE ADD
(ID_ATTIVITA_ATECO NUMBER(4),
 ID_FORMA_GIURIDICA NUMBER(3)
);
--
-- FK
ALTER TABLE PBANDI_T_FORNITORE ADD 
CONSTRAINT FK_PBANDI_D_FORMA_GIURIDICA_07
 FOREIGN KEY (ID_FORMA_GIURIDICA)
 REFERENCES PBANDI_D_FORMA_GIURIDICA  (ID_FORMA_GIURIDICA);
 -- FK
ALTER TABLE PBANDI_T_FORNITORE ADD 
CONSTRAINT FK_PBANDI_D_ATTIVITA_ATECO_07
 FOREIGN KEY (ID_ATTIVITA_ATECO)
 REFERENCES PBANDI_D_ATTIVITA_ATECO (ID_ATTIVITA_ATECO);
-- 
ALTER TABLE PBANDI_T_FORNITORE ADD
(ID_NAZIONE NUMBER(3));

ALTER TABLE PBANDI_T_FORNITORE ADD 
CONSTRAINT FK_PBANDI_D_NAZIONE_06
 FOREIGN KEY (ID_NAZIONE)
 REFERENCES PBANDI_D_NAZIONE (ID_NAZIONE);
--
--INDEX
CREATE INDEX IE1_PBANDI_T_FORNITORE ON PBANDI_T_FORNITORE (ID_FORMA_GIURIDICA)   TABLESPACE PBANDI_IDX;
CREATE INDEX IE2_PBANDI_T_FORNITORE ON PBANDI_T_FORNITORE (ID_ATTIVITA_ATECO)   TABLESPACE PBANDI_IDX;
CREATE INDEX IE3_PBANDI_T_FORNITORE ON PBANDI_T_FORNITORE (ID_NAZIONE) TABLESPACE PBANDI_IDX;

-- PBANDI_R_LINEA_MOD_AGEVOL
CREATE TABLE PBANDI_R_LINEA_MOD_AGEVOL
(ID_MODALITA_AGEVOLAZIONE NUMBER (3) NOT NULL,
ID_LINEA_DI_INTERVENTO NUMBER (3) NOT NULL
);
--PK
ALTER TABLE PBANDI_R_LINEA_MOD_AGEVOL ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_LINEA_MOD_AGEVOL PRIMARY KEY (ID_MODALITA_AGEVOLAZIONE,ID_LINEA_DI_INTERVENTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
 
--FK
ALTER TABLE PBANDI_R_LINEA_MOD_AGEVOL ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_55
 FOREIGN KEY (ID_LINEA_DI_INTERVENTO)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
--FK
ALTER TABLE PBANDI_R_LINEA_MOD_AGEVOL ADD 
CONSTRAINT FK_PBANDI_D_MODALITA_AGEVOL_08
 FOREIGN KEY (ID_MODALITA_AGEVOLAZIONE)
 REFERENCES PBANDI_D_MODALITA_AGEVOLAZIONE  (ID_MODALITA_AGEVOLAZIONE);
 
--
-- PBANDI_D_ATTIVITA_ATECO
ALTER TABLE PBANDI_D_ATTIVITA_ATECO ADD
(LIVELLO NUMBER (3)	
);
--
ALTER TABLE PBANDI_T_BANDO ADD
(DATA_DETERMINA_APPROVAZIONE DATE
);
--
-- PBANDI_D_NATURA_CIPE
ALTER TABLE PBANDI_D_NATURA_CIPE ADD
(ID_TIPO_OPERAZIONE NUMBER(3)
);
ALTER TABLE PBANDI_D_NATURA_CIPE ADD 
CONSTRAINT FK_PBANDI_D_TIPO_OPERAZIONE_07
 FOREIGN KEY (ID_TIPO_OPERAZIONE)
 REFERENCES PBANDI_D_TIPO_OPERAZIONE (ID_TIPO_OPERAZIONE);
--
-- PBANDI_D_ITER
ALTER TABLE PBANDI_D_ITER ADD
(ID_NATURA_CIPE NUMBER(3)
);
ALTER TABLE PBANDI_D_ITER ADD
CONSTRAINT FK_PBANDI_D_NATURA_CIPE_04
 FOREIGN KEY (ID_NATURA_CIPE)
 REFERENCES PBANDI_D_NATURA_CIPE (ID_NATURA_CIPE);

 -- PBANDI_D_VOCE_DI_SPESA_MONIT
ALTER TABLE PBANDI_D_VOCE_DI_SPESA_MONIT ADD
(ID_NATURA_CIPE NUMBER(3)
);
ALTER TABLE PBANDI_D_VOCE_DI_SPESA_MONIT ADD
CONSTRAINT FK_PBANDI_D_NATURA_CIPE_05
 FOREIGN KEY (ID_NATURA_CIPE)
 REFERENCES PBANDI_D_NATURA_CIPE (ID_NATURA_CIPE);

 -- PBANDI_T_PAGAMENTO
 ALTER TABLE PBANDI_T_PAGAMENTO ADD
 (RIF_PAGAMENTO VARCHAR2(20));
--
-- PBANDI_T_PROCEDURA_AGGIUDICAZ
ALTER TABLE PBANDI_T_PROCEDURA_AGGIUDICAZ ADD
(ID_MOTIVO_ASSENZA_CIG  NUMBER (3)
);
ALTER TABLE PBANDI_T_PROCEDURA_AGGIUDICAZ ADD
CONSTRAINT FK_PBANDI_D_MOTIVO_ASS_CIG_02
 FOREIGN KEY (ID_MOTIVO_ASSENZA_CIG)
 REFERENCES PBANDI_D_MOTIVO_ASSENZA_CIG (ID_MOTIVO_ASSENZA_CIG);
 
 -- PBANDI_T_APPALTO
ALTER TABLE PBANDI_T_APPALTO ADD
(ID_TIPO_PERCETTORE NUMBER (3) 
); 
ALTER TABLE PBANDI_T_APPALTO ADD
CONSTRAINT FK_PBANDI_D_TIPO_PERCET_02
 FOREIGN KEY (ID_TIPO_PERCETTORE)
 REFERENCES PBANDI_D_TIPO_PERCETTORE (ID_TIPO_PERCETTORE);

 -- PBANDI_R_FORNITORE_APPALTO
CREATE TABLE PBANDI_R_FORNITORE_APPALTO
(ID_FORNITORE NUMBER(8),
ID_APPALTO NUMBER(8),
ID_TIPO_PERCETTORE NUMBER(3)
);
--PK
ALTER TABLE PBANDI_R_FORNITORE_APPALTO ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_FORNITORE_APPALTO PRIMARY KEY (ID_FORNITORE,ID_APPALTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
 --FK
ALTER TABLE PBANDI_R_FORNITORE_APPALTO ADD 
CONSTRAINT FK_PBANDI_T_FORNITORE_03
 FOREIGN KEY (ID_FORNITORE)
 REFERENCES PBANDI_T_FORNITORE (ID_FORNITORE);
 --FK
ALTER TABLE PBANDI_R_FORNITORE_APPALTO ADD 
CONSTRAINT FK_PBANDI_T_APPALTO_03
 FOREIGN KEY (ID_APPALTO)
 REFERENCES PBANDI_T_APPALTO (ID_APPALTO);
 --FK
ALTER TABLE PBANDI_R_FORNITORE_APPALTO ADD 
CONSTRAINT FK_PBANDI_D_TIPO_PERCETTORE_01
 FOREIGN KEY (ID_TIPO_PERCETTORE)
 REFERENCES PBANDI_D_TIPO_PERCETTORE (ID_TIPO_PERCETTORE);
--
CREATE INDEX IE1_PBANDI_R_FORNITORE_APPALTO ON PBANDI_R_FORNITORE_APPALTO
(ID_APPALTO)
TABLESPACE PBANDI_IDX;
--
CREATE INDEX IE2_PBANDI_R_FORNITORE_APPALTO ON PBANDI_R_FORNITORE_APPALTO
(ID_TIPO_PERCETTORE)
TABLESPACE PBANDI_IDX;
--
--PBANDI_C_PERC_SPESA_PUBBLICA
CREATE TABLE PBANDI_C_PERC_SPESA_PUBBLICA 
   (NUM_PERC  NUMBER(3),
    NUM_NEXT_PERC NUMBER(3),
	PERC_TEST_PAG_VAL  NUMBER(3));
	
COMMENT ON TABLE PBANDI_C_PERC_SPESA_PUBBLICA IS 'Tabella che indica le percentuali da applicare alla spesa pubblica per calcolare il certificabile lordo';
COMMENT ON COLUMN PBANDI_C_PERC_SPESA_PUBBLICA.PERC_TEST_PAG_VAL IS 'Percentuale per il test sui pagamenti validati rispetto al certificato netto';
   
ALTER TABLE PBANDI_C_PERC_SPESA_PUBBLICA ADD  
 ( 
  CONSTRAINT PK_PBANDI_C_PERC_SPESA_PUBBL PRIMARY KEY (NUM_PERC)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
 
ALTER TABLE PBANDI_C_PERC_SPESA_PUBBLICA ADD 
CONSTRAINT FK_PBANDI_C_PERC_SPESA_PUBB_01
 FOREIGN KEY (NUM_NEXT_PERC)
 REFERENCES PBANDI_C_PERC_SPESA_PUBBLICA  (NUM_PERC);
 
--PBANDI_T_DETT_PROPOSTA_CERTIF
ALTER TABLE PBANDI_T_DETT_PROPOSTA_CERTIF
 ADD (NOTA  VARCHAR2(4000));

--PBANDI_T_DETT_PROPOSTA_CERTIF  
ALTER TABLE PBANDI_T_DETT_PROPOSTA_CERTIF
 ADD (QUOTA_REVOCA_PER_IRR  NUMBER(17,2));
 
--PBANDI_T_DETT_PROPOSTA_CERTIF  
ALTER TABLE PBANDI_T_DETT_PROPOSTA_CERTIF
 ADD (NUM_PERC_SPESA_PUBBLICA  NUMBER(3));
 
ALTER TABLE PBANDI_T_DETT_PROPOSTA_CERTIF ADD 
CONSTRAINT FK_PBANDI_C_PERC_SPESA_PUBB_02
 FOREIGN KEY (NUM_PERC_SPESA_PUBBLICA)
 REFERENCES PBANDI_C_PERC_SPESA_PUBBLICA  (NUM_PERC);
 
--PBANDI_R_DETT_PROP_CERT_REVOCA 
ALTER TABLE PBANDI_R_DETT_PROP_CERT_REVOCA 
 ADD (ID_PROGETTO_PERCETTORE   NUMBER(8),
      QUOTA_REVOCA_PER_IRR  NUMBER(17,2));

ALTER TABLE PBANDI_R_DETT_PROP_CERT_REVOCA ADD (
  CONSTRAINT FK_PBANDI_T_PROGETTO_39 
  FOREIGN KEY (ID_PROGETTO_PERCETTORE) 
  REFERENCES PBANDI_T_PROGETTO (ID_PROGETTO));

--PBANDI_R_DETT_PROP_CERTIF_RECU
ALTER TABLE PBANDI_R_DETT_PROP_CERTIF_RECU 
 ADD (ID_PROGETTO_PERCETTORE   NUMBER(8));

ALTER TABLE PBANDI_R_DETT_PROP_CERTIF_RECU ADD (
  CONSTRAINT FK_PBANDI_T_PROGETTO_40 
  FOREIGN KEY (ID_PROGETTO_PERCETTORE) 
  REFERENCES PBANDI_T_PROGETTO (ID_PROGETTO));
  
--PBANDI_R_DETT_PROP_CERT_EROGAZ  
ALTER TABLE PBANDI_R_DETT_PROP_CERT_EROGAZ 
 ADD (ID_PROGETTO_PERCETTORE   NUMBER(8));

ALTER TABLE PBANDI_R_DETT_PROP_CERT_EROGAZ ADD (
  CONSTRAINT FK_PBANDI_T_PROGETTO_41
  FOREIGN KEY (ID_PROGETTO_PERCETTORE) 
  REFERENCES PBANDI_T_PROGETTO (ID_PROGETTO));
  
--PBANDI_R_BANDO_LINEA_INTERVENT 
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD
(ID_CLASSIFICAZIONE_MET NUMBER(3)
);
--FK
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD 
CONSTRAINT FK_PBANDI_D_CLASSIF_MET_02
 FOREIGN KEY (ID_CLASSIFICAZIONE_MET)
 REFERENCES PBANDI_D_CLASSIFICAZIONE_MET  (ID_CLASSIFICAZIONE_MET);
--

--PBANDI_D_ITER
ALTER TABLE PBANDI_D_ITER MODIFY ID_TIPO_OPERAZIONE NULL;
--
-- PBANDI_D_CAUSALE_EROGAZIONE
ALTER TABLE PBANDI_D_CAUSALE_EROGAZIONE ADD
(ID_CAUSALE_TRASFERIMENTO NUMBER (3)
);
--FK
ALTER TABLE PBANDI_D_CAUSALE_EROGAZIONE ADD 
CONSTRAINT FK_PBANDI_D_CAUS_TRASF_02
 FOREIGN KEY (ID_CAUSALE_TRASFERIMENTO)
 REFERENCES PBANDI_D_CAUSALE_TRASFERIMENTO  (ID_CAUSALE_TRASFERIMENTO);
--

--
--  PBANDI_D_GRANDE_PROGETTO
CREATE TABLE PBANDI_D_GRANDE_PROGETTO
   (ID_GRANDE_PROGETTO NUMBER(3),
   COD_GRANDE_PROGETTO VARCHAR2(50),
   DESC_GRANDE_PROGETTO VARCHAR2(255),
   COD_PROGRAMMA VARCHAR2(50)
   );
-- PK
ALTER TABLE PBANDI_D_GRANDE_PROGETTO ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_GRANDE_PROGETTO PRIMARY KEY (ID_GRANDE_PROGETTO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--
-- PBANDI_T_PROGETTO
ALTER TABLE PBANDI_T_PROGETTO ADD ID_GRANDE_PROGETTO NUMBER(3);
--
ALTER TABLE PBANDI_T_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_GRANDE_PROGETTO_01
 FOREIGN KEY (ID_GRANDE_PROGETTO)
 REFERENCES PBANDI_D_GRANDE_PROGETTO  (ID_GRANDE_PROGETTO);
--
CREATE INDEX IE3_PBANDI_T_PROGETTO ON PBANDI_T_PROGETTO (ID_GRANDE_PROGETTO)  TABLESPACE PBANDI_IDX;
--
--PBANDI_T_CSP_PROGETTO
ALTER TABLE PBANDI_T_CSP_PROGETTO ADD ID_GRANDE_PROGETTO NUMBER(3);
--
ALTER TABLE PBANDI_T_CSP_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_GRANDE_PROGETTO_02
 FOREIGN KEY (ID_GRANDE_PROGETTO)
 REFERENCES PBANDI_D_GRANDE_PROGETTO  (ID_GRANDE_PROGETTO);
--
CREATE INDEX IE1_PBANDI_T_CSP_PROGETTO ON PBANDI_T_CSP_PROGETTO (ID_GRANDE_PROGETTO)  TABLESPACE PBANDI_IDX;
--

--
-- PBANDI_R_BANDO_LINEA_INTERVENT
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD
(FLAG_FONDO_DI_FONDI VARCHAR2(1)
);
-- Check
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD
 (
  CONSTRAINT CHK_FLAG_FONDO_DI_FONDI  CHECK (FLAG_FONDO_DI_FONDI IN ('S', 'N', NULL))
  );
--
--  PBANDI_T_PROGETTO
ALTER TABLE PBANDI_T_PROGETTO ADD (
ID_GR_VULNERABILI_PROG NUMBER (3) DEFAULT 3
);

INSERT INTO PBANDI_D_GR_VULNERABILI_PROG VALUES (3,'NOVULN','Progetto NON destinato a gruppo vulnerabile',SYSDATE,NULL,NULL);
COMMIT;

-- FK
ALTER TABLE PBANDI_T_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_GR_VULNE_PROG_02
 FOREIGN KEY (ID_GR_VULNERABILI_PROG)
 REFERENCES PBANDI_D_GR_VULNERABILI_PROG  (ID_GR_VULNERABILI_PROG);
--

--
Insert into PBANDI_D_TIPO_LOCALIZZAZIONE
   (ID_TIPO_LOCALIZZAZIONE, DESC_BREVE_TIPO_LOCAL, DESC_TIPO_LOCALIZZAZIONE, DT_INIZIO_VALIDITA, TC10)
 Values
   (3, 'PUN', 'Puntuale', TO_DATE('01/01/2016 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'C');
COMMIT;
--


-- PBANDI_T_PROGETTO
ALTER TABLE PBANDI_T_PROGETTO ADD (
ID_TIPO_LOCALIZZAZIONE NUMBER (3) DEFAULT 3
);
-- FK
ALTER TABLE PBANDI_T_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_TIPO_LOCAL_03
 FOREIGN KEY (ID_TIPO_LOCALIZZAZIONE)
 REFERENCES PBANDI_D_TIPO_LOCALIZZAZIONE  (ID_TIPO_LOCALIZZAZIONE);
--

CREATE TABLE PBANDI_D_SPECIFICA_STATO 
(ID_SPECIFICA_STATO NUMBER(3),
 DESCR_SPECIFICA_STATO  VARCHAR2(100),
 STATO NUMBER(1));
 
COMMENT ON TABLE PBANDI_D_SPECIFICA_STATO IS 'Specificazioni dello stato del progetto';
COMMENT ON COLUMN  PBANDI_D_SPECIFICA_STATO.STATO IS 'Stato del progetto 1=Attivo, 2=Non attivo';

-- PK
ALTER TABLE PBANDI_D_SPECIFICA_STATO ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_SPECIFICA_STATO PRIMARY KEY (ID_SPECIFICA_STATO)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );

-- Check
ALTER TABLE PBANDI_D_SPECIFICA_STATO ADD
 (
  CONSTRAINT CHK_PBANDI_D_SPECIFICA_STATO  CHECK (STATO IN (1, 2))
  );

-- 
Insert into PBANDI.PBANDI_D_SPECIFICA_STATO
   (ID_SPECIFICA_STATO, DESCR_SPECIFICA_STATO, STATO)
 Values
   (0, 'Attivo', 1);
COMMIT; 
--  
--  PBANDI_T_PROGETTO
ALTER TABLE PBANDI_T_PROGETTO ADD (
ID_SPECIFICA_STATO NUMBER (3) DEFAULT 0
);

COMMENT ON COLUMN  PBANDI_T_PROGETTO.ID_SPECIFICA_STATO IS 'Specificazione dello stato del progetto se il progetto non è attivo';

-- FK
ALTER TABLE PBANDI_T_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_SPECIFICA_STATO_01
 FOREIGN KEY (ID_SPECIFICA_STATO)
 REFERENCES PBANDI_D_SPECIFICA_STATO  (ID_SPECIFICA_STATO);
 
--
CREATE INDEX IE4_PBANDI_T_PROGETTO ON PBANDI_T_PROGETTO (ID_SPECIFICA_STATO)  TABLESPACE PBANDI_IDX;

--  PBANDI_T_PROGETTO
ALTER TABLE PBANDI_T_PROGETTO ADD (
ID_PROGETTO_FINANZ NUMBER (8)
);

COMMENT ON COLUMN  PBANDI_T_PROGETTO.ID_PROGETTO_FINANZ IS 'ID del progetto di finanziamento a cui il progetto di contributo è referenziato';

-- FK
ALTER TABLE PBANDI_T_PROGETTO ADD 
CONSTRAINT FK_PBANDI_T_PROGETTO_42
 FOREIGN KEY (ID_PROGETTO_FINANZ)
 REFERENCES PBANDI_T_PROGETTO  (ID_PROGETTO);
 
--
CREATE INDEX IE5_PBANDI_T_PROGETTO ON PBANDI_T_PROGETTO (ID_PROGETTO_FINANZ)  TABLESPACE PBANDI_IDX;
--

-- PBANDI_T_PROCEDURA_AGGIUDICAZ
ALTER TABLE PBANDI_T_PROCEDURA_AGGIUDICAZ ADD
(DT_AGGIUDICAZIONE DATE );

-- PBANDI_D_OBIETTIVO_TEM
CREATE TABLE PBANDI_D_OBIETTIVO_TEM
(ID_OBIETTIVO_TEM NUMBER(3),
 COD_OBIETTIVO_TEM VARCHAR2(50),       
 DESCR_OBIETTIVO_TEM VARCHAR2(1000)
);
-- PK
ALTER TABLE PBANDI_D_OBIETTIVO_TEM ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_OBIETTIVO_TEM PRIMARY KEY (ID_OBIETTIVO_TEM)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );

-- PBANDI_D_CLASSIFICAZIONE_RA
CREATE TABLE PBANDI_D_CLASSIFICAZIONE_RA
(ID_CLASSIFICAZIONE_RA NUMBER(3), 
 COD_CLASSIFICAZIONE_RA VARCHAR2(200),
 DESCR_CLASSIFICAZIONE_RA VARCHAR2(1000)
);
-- PK
ALTER TABLE PBANDI_D_CLASSIFICAZIONE_RA ADD  
 ( 
  CONSTRAINT PK_PBANDI_D_CLASS_RA PRIMARY KEY (ID_CLASSIFICAZIONE_RA)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );

-- PBANDI_R_OBBTEM_CLASSRA
CREATE TABLE PBANDI_R_OBTEM_CLASSRA 
(ID_OBIETTIVO_TEM NUMBER(3),
 ID_CLASSIFICAZIONE_RA NUMBER(3)
);
-- PK
ALTER TABLE PBANDI_R_OBTEM_CLASSRA  ADD  
 ( 
  CONSTRAINT PK_PBANDI_R_OBTEM_CLASSRA PRIMARY KEY (ID_OBIETTIVO_TEM,ID_CLASSIFICAZIONE_RA)
  USING INDEX
  TABLESPACE PBANDI_IDX 
 );
--FK
ALTER TABLE PBANDI_R_OBTEM_CLASSRA ADD 
CONSTRAINT FK_PPBANDI_D_OBIET_TEM_01
 FOREIGN KEY (ID_OBIETTIVO_TEM)
 REFERENCES PBANDI_D_OBIETTIVO_TEM (ID_OBIETTIVO_TEM);
--FK
ALTER TABLE PBANDI_R_OBTEM_CLASSRA ADD 
CONSTRAINT FK_PBANDI_D_CLASS_RA_01
 FOREIGN KEY (ID_CLASSIFICAZIONE_RA)
 REFERENCES PBANDI_D_CLASSIFICAZIONE_RA (ID_CLASSIFICAZIONE_RA);
--
--PBANDI_T_PROGETTO
ALTER TABLE PBANDI_T_PROGETTO ADD
(ID_CLASSIFICAZIONE_RA NUMBER(3));
--FK
ALTER TABLE PBANDI_T_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_CLASS_RA_02
 FOREIGN KEY (ID_CLASSIFICAZIONE_RA)
 REFERENCES PBANDI_D_CLASSIFICAZIONE_RA (ID_CLASSIFICAZIONE_RA);
--PBANDI_T_CSP_PROGETTO
ALTER TABLE PBANDI_T_CSP_PROGETTO ADD
(ID_CLASSIFICAZIONE_RA NUMBER(3));
--FK
ALTER TABLE PBANDI_T_CSP_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_CLASS_RA_03
 FOREIGN KEY (ID_CLASSIFICAZIONE_RA)
 REFERENCES PBANDI_D_CLASSIFICAZIONE_RA (ID_CLASSIFICAZIONE_RA);
--PBANDI_R_BANDO_LINEA_INTERVENT
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD
(ID_CLASSIFICAZIONE_RA NUMBER(3));
--FK
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD 
CONSTRAINT FK_PBANDI_D_CLASS_RA_04
 FOREIGN KEY (ID_CLASSIFICAZIONE_RA)
 REFERENCES PBANDI_D_CLASSIFICAZIONE_RA (ID_CLASSIFICAZIONE_RA);
--
--PBANDI_T_PROGETTO
ALTER TABLE PBANDI_T_PROGETTO ADD ABSTRACT_PROGETTO CLOB;

-- PBANDI_D_LINEA_DI_INTERVENTO
ALTER TABLE PBANDI_D_LINEA_DI_INTERVENTO ADD
(COD_LIV_GERARCHICO VARCHAR2 (18));
--

--PBANDI_T_PROPOSTA_CERTIFICAZ
ALTER TABLE PBANDI_T_PROPOSTA_CERTIFICAZ
 ADD (DT_DOMANDA_PAGAMENTO  DATE);

COMMENT ON COLUMN PBANDI_T_PROPOSTA_CERTIFICAZ.DT_DOMANDA_PAGAMENTO IS 'Data di presentazione della domanda di pagamento';
-- 
-- PBANDI_T_CSP_PROGETTO
ALTER TABLE PBANDI_T_CSP_PROGETTO ADD (ID_OBIETTIVO_TEM NUMBER(3));
--FK
ALTER TABLE PBANDI_T_CSP_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_OBIET_TEM_02
 FOREIGN KEY (ID_OBIETTIVO_TEM)
 REFERENCES PBANDI_D_OBIETTIVO_TEM (ID_OBIETTIVO_TEM);
--
-- PBANDI_T_PROGETTO
ALTER TABLE PBANDI_T_PROGETTO ADD (ID_OBIETTIVO_TEM NUMBER(3));
--FK
ALTER TABLE PBANDI_T_PROGETTO ADD 
CONSTRAINT FK_PBANDI_D_OBIET_TEM_03
 FOREIGN KEY (ID_OBIETTIVO_TEM)
 REFERENCES PBANDI_D_OBIETTIVO_TEM (ID_OBIETTIVO_TEM);
--
ALTER TABLE PBANDI_D_VOCE_DI_SPESA_MONIT MODIFY ID_TIPO_OPERAZIONE NULL;
ALTER TABLE PBANDI_R_BANDO_LINEA_INTERVENT ADD COD_AIUTO_RNA VARCHAR2(30);
--
-- PBANDI_D_IND_RISULTATO_PROGRAM
ALTER TABLE PBANDI_D_IND_RISULTATO_PROGRAM MODIFY COD_IGRUE_T20 NULL;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = NULL;
ALTER TABLE PBANDI_D_IND_RISULTATO_PROGRAM MODIFY COD_IGRUE_T20 VARCHAR2(5);
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '1' WHERE ID_IND_RISULTATO_PROGRAM = 1;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '2' WHERE ID_IND_RISULTATO_PROGRAM = 2;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '3' WHERE ID_IND_RISULTATO_PROGRAM = 3;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '4' WHERE ID_IND_RISULTATO_PROGRAM = 4;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '5' WHERE ID_IND_RISULTATO_PROGRAM = 5;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '6' WHERE ID_IND_RISULTATO_PROGRAM = 6;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '7' WHERE ID_IND_RISULTATO_PROGRAM = 7;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '8' WHERE ID_IND_RISULTATO_PROGRAM = 8;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '9' WHERE ID_IND_RISULTATO_PROGRAM = 9;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '10' WHERE ID_IND_RISULTATO_PROGRAM = 10;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '11' WHERE ID_IND_RISULTATO_PROGRAM = 11;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '12' WHERE ID_IND_RISULTATO_PROGRAM = 12;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '13' WHERE ID_IND_RISULTATO_PROGRAM = 13;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '14' WHERE ID_IND_RISULTATO_PROGRAM = 14;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '15' WHERE ID_IND_RISULTATO_PROGRAM = 15;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '16' WHERE ID_IND_RISULTATO_PROGRAM = 16;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '17' WHERE ID_IND_RISULTATO_PROGRAM = 17;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '18' WHERE ID_IND_RISULTATO_PROGRAM = 18;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '19' WHERE ID_IND_RISULTATO_PROGRAM = 19;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '20' WHERE ID_IND_RISULTATO_PROGRAM = 20;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '21' WHERE ID_IND_RISULTATO_PROGRAM = 21;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '22' WHERE ID_IND_RISULTATO_PROGRAM = 22;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '23' WHERE ID_IND_RISULTATO_PROGRAM = 23;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '24' WHERE ID_IND_RISULTATO_PROGRAM = 24;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '25' WHERE ID_IND_RISULTATO_PROGRAM = 25;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '26' WHERE ID_IND_RISULTATO_PROGRAM = 26;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '27' WHERE ID_IND_RISULTATO_PROGRAM = 27;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '1' WHERE ID_IND_RISULTATO_PROGRAM = 28;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '10' WHERE ID_IND_RISULTATO_PROGRAM = 29;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '11' WHERE ID_IND_RISULTATO_PROGRAM = 30;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '12' WHERE ID_IND_RISULTATO_PROGRAM = 31;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '13' WHERE ID_IND_RISULTATO_PROGRAM = 32;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '14' WHERE ID_IND_RISULTATO_PROGRAM = 33;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '15' WHERE ID_IND_RISULTATO_PROGRAM = 34;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '16' WHERE ID_IND_RISULTATO_PROGRAM = 35;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '17' WHERE ID_IND_RISULTATO_PROGRAM = 36;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '18' WHERE ID_IND_RISULTATO_PROGRAM = 37;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '19' WHERE ID_IND_RISULTATO_PROGRAM = 38;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '2' WHERE ID_IND_RISULTATO_PROGRAM = 39;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '20' WHERE ID_IND_RISULTATO_PROGRAM = 40;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '21' WHERE ID_IND_RISULTATO_PROGRAM = 41;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '22' WHERE ID_IND_RISULTATO_PROGRAM = 42;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '23' WHERE ID_IND_RISULTATO_PROGRAM = 43;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '24' WHERE ID_IND_RISULTATO_PROGRAM = 44;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '25' WHERE ID_IND_RISULTATO_PROGRAM = 45;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '26' WHERE ID_IND_RISULTATO_PROGRAM = 46;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '27' WHERE ID_IND_RISULTATO_PROGRAM = 47;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '28' WHERE ID_IND_RISULTATO_PROGRAM = 48;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '29' WHERE ID_IND_RISULTATO_PROGRAM = 49;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '3' WHERE ID_IND_RISULTATO_PROGRAM = 50;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '30' WHERE ID_IND_RISULTATO_PROGRAM = 51;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '31' WHERE ID_IND_RISULTATO_PROGRAM = 52;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '32' WHERE ID_IND_RISULTATO_PROGRAM = 53;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '33' WHERE ID_IND_RISULTATO_PROGRAM = 54;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '34' WHERE ID_IND_RISULTATO_PROGRAM = 55;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '35' WHERE ID_IND_RISULTATO_PROGRAM = 56;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '36' WHERE ID_IND_RISULTATO_PROGRAM = 57;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '37' WHERE ID_IND_RISULTATO_PROGRAM = 58;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '38' WHERE ID_IND_RISULTATO_PROGRAM = 59;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '39' WHERE ID_IND_RISULTATO_PROGRAM = 60;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '4' WHERE ID_IND_RISULTATO_PROGRAM = 61;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '40' WHERE ID_IND_RISULTATO_PROGRAM = 62;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '41' WHERE ID_IND_RISULTATO_PROGRAM = 63;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '42' WHERE ID_IND_RISULTATO_PROGRAM = 64;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '43' WHERE ID_IND_RISULTATO_PROGRAM = 65;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '44' WHERE ID_IND_RISULTATO_PROGRAM = 66;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '5' WHERE ID_IND_RISULTATO_PROGRAM = 67;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '6' WHERE ID_IND_RISULTATO_PROGRAM = 68;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '7' WHERE ID_IND_RISULTATO_PROGRAM = 69;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '8' WHERE ID_IND_RISULTATO_PROGRAM = 70;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '9' WHERE ID_IND_RISULTATO_PROGRAM = 71;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '1' WHERE ID_IND_RISULTATO_PROGRAM = 72;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '10' WHERE ID_IND_RISULTATO_PROGRAM = 73;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '11' WHERE ID_IND_RISULTATO_PROGRAM = 74;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '12' WHERE ID_IND_RISULTATO_PROGRAM = 75;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '13' WHERE ID_IND_RISULTATO_PROGRAM = 76;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '14' WHERE ID_IND_RISULTATO_PROGRAM = 77;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '15' WHERE ID_IND_RISULTATO_PROGRAM = 78;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '16' WHERE ID_IND_RISULTATO_PROGRAM = 79;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '17' WHERE ID_IND_RISULTATO_PROGRAM = 80;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '18' WHERE ID_IND_RISULTATO_PROGRAM = 81;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '19' WHERE ID_IND_RISULTATO_PROGRAM = 82;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '2' WHERE ID_IND_RISULTATO_PROGRAM = 83;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '3' WHERE ID_IND_RISULTATO_PROGRAM = 84;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '4' WHERE ID_IND_RISULTATO_PROGRAM = 85;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '5' WHERE ID_IND_RISULTATO_PROGRAM = 86;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '6' WHERE ID_IND_RISULTATO_PROGRAM = 87;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '7' WHERE ID_IND_RISULTATO_PROGRAM = 88;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '8' WHERE ID_IND_RISULTATO_PROGRAM = 89;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '9' WHERE ID_IND_RISULTATO_PROGRAM = 90;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '1' WHERE ID_IND_RISULTATO_PROGRAM = 91;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '10' WHERE ID_IND_RISULTATO_PROGRAM = 92;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '11' WHERE ID_IND_RISULTATO_PROGRAM = 93;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '12' WHERE ID_IND_RISULTATO_PROGRAM = 94;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '13' WHERE ID_IND_RISULTATO_PROGRAM = 95;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '14' WHERE ID_IND_RISULTATO_PROGRAM = 96;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '15' WHERE ID_IND_RISULTATO_PROGRAM = 97;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '16' WHERE ID_IND_RISULTATO_PROGRAM = 98;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '17' WHERE ID_IND_RISULTATO_PROGRAM = 99;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '18' WHERE ID_IND_RISULTATO_PROGRAM = 100;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '19' WHERE ID_IND_RISULTATO_PROGRAM = 101;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '2' WHERE ID_IND_RISULTATO_PROGRAM = 102;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '20' WHERE ID_IND_RISULTATO_PROGRAM = 103;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '21' WHERE ID_IND_RISULTATO_PROGRAM = 104;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '22' WHERE ID_IND_RISULTATO_PROGRAM = 105;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '23' WHERE ID_IND_RISULTATO_PROGRAM = 106;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '24' WHERE ID_IND_RISULTATO_PROGRAM = 107;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '25' WHERE ID_IND_RISULTATO_PROGRAM = 108;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '26' WHERE ID_IND_RISULTATO_PROGRAM = 109;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '27' WHERE ID_IND_RISULTATO_PROGRAM = 110;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '28' WHERE ID_IND_RISULTATO_PROGRAM = 111;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '29' WHERE ID_IND_RISULTATO_PROGRAM = 112;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '3' WHERE ID_IND_RISULTATO_PROGRAM = 113;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '30' WHERE ID_IND_RISULTATO_PROGRAM = 114;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '31' WHERE ID_IND_RISULTATO_PROGRAM = 115;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '32' WHERE ID_IND_RISULTATO_PROGRAM = 116;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '33' WHERE ID_IND_RISULTATO_PROGRAM = 117;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '34' WHERE ID_IND_RISULTATO_PROGRAM = 118;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '35' WHERE ID_IND_RISULTATO_PROGRAM = 119;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '4' WHERE ID_IND_RISULTATO_PROGRAM = 120;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '5' WHERE ID_IND_RISULTATO_PROGRAM = 121;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '6' WHERE ID_IND_RISULTATO_PROGRAM = 122;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '7' WHERE ID_IND_RISULTATO_PROGRAM = 123;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '8' WHERE ID_IND_RISULTATO_PROGRAM = 124;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '9' WHERE ID_IND_RISULTATO_PROGRAM = 125;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '7' WHERE ID_IND_RISULTATO_PROGRAM = 126;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '36' WHERE ID_IND_RISULTATO_PROGRAM = 127;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '37' WHERE ID_IND_RISULTATO_PROGRAM = 128;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '38' WHERE ID_IND_RISULTATO_PROGRAM = 129;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '39' WHERE ID_IND_RISULTATO_PROGRAM = 130;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '40' WHERE ID_IND_RISULTATO_PROGRAM = 131;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '41' WHERE ID_IND_RISULTATO_PROGRAM = 132;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '42' WHERE ID_IND_RISULTATO_PROGRAM = 133;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '43' WHERE ID_IND_RISULTATO_PROGRAM = 134;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '44' WHERE ID_IND_RISULTATO_PROGRAM = 135;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '45' WHERE ID_IND_RISULTATO_PROGRAM = 136;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '46' WHERE ID_IND_RISULTATO_PROGRAM = 137;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '47' WHERE ID_IND_RISULTATO_PROGRAM = 138;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '48' WHERE ID_IND_RISULTATO_PROGRAM = 139;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '49' WHERE ID_IND_RISULTATO_PROGRAM = 141;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '50' WHERE ID_IND_RISULTATO_PROGRAM = 142;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '51' WHERE ID_IND_RISULTATO_PROGRAM = 143;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '52' WHERE ID_IND_RISULTATO_PROGRAM = 144;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '53' WHERE ID_IND_RISULTATO_PROGRAM = 145;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '54' WHERE ID_IND_RISULTATO_PROGRAM = 146;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '55' WHERE ID_IND_RISULTATO_PROGRAM = 147;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '56' WHERE ID_IND_RISULTATO_PROGRAM = 148;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '57' WHERE ID_IND_RISULTATO_PROGRAM = 149;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '58' WHERE ID_IND_RISULTATO_PROGRAM = 150;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '59' WHERE ID_IND_RISULTATO_PROGRAM = 151;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '60' WHERE ID_IND_RISULTATO_PROGRAM = 152;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '61' WHERE ID_IND_RISULTATO_PROGRAM = 153;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '62' WHERE ID_IND_RISULTATO_PROGRAM = 154;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '63' WHERE ID_IND_RISULTATO_PROGRAM = 155;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '64' WHERE ID_IND_RISULTATO_PROGRAM = 156;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '65' WHERE ID_IND_RISULTATO_PROGRAM = 157;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '66' WHERE ID_IND_RISULTATO_PROGRAM = 158;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '67' WHERE ID_IND_RISULTATO_PROGRAM = 159;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '68' WHERE ID_IND_RISULTATO_PROGRAM = 160;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '69' WHERE ID_IND_RISULTATO_PROGRAM = 161;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '70' WHERE ID_IND_RISULTATO_PROGRAM = 162;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '71' WHERE ID_IND_RISULTATO_PROGRAM = 163;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '72' WHERE ID_IND_RISULTATO_PROGRAM = 164;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '73' WHERE ID_IND_RISULTATO_PROGRAM = 165;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '74' WHERE ID_IND_RISULTATO_PROGRAM = 166;
UPDATE PBANDI_D_IND_RISULTATO_PROGRAM SET COD_IGRUE_T20 = '3' WHERE ID_IND_RISULTATO_PROGRAM = 167;
COMMIT;
ALTER TABLE PBANDI_D_IND_RISULTATO_PROGRAM MODIFY COD_IGRUE_T20 NOT NULL;
--
--
-- PBANDI_D_MICRO_SEZIONE_DIN
ALTER TABLE PBANDI_D_MICRO_SEZIONE_DIN ADD ID_LINEA_NORMATIVA NUMBER(3);
-- FK 
ALTER TABLE PBANDI_D_MICRO_SEZIONE_DIN ADD 
CONSTRAINT FK_PBANDI_D_LINEA_INTERV_56
 FOREIGN KEY (ID_LINEA_NORMATIVA)
 REFERENCES PBANDI_D_LINEA_DI_INTERVENTO (ID_LINEA_DI_INTERVENTO);
--
-- PBANDI_D_VOCE_DI_SPESA_MONIT
ALTER TABLE PBANDI_D_VOCE_DI_SPESA_MONIT MODIFY COD_IGRUE_T28 NULL;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = NULL;
ALTER TABLE PBANDI_D_VOCE_DI_SPESA_MONIT MODIFY COD_IGRUE_T28 VARCHAR2(2);
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '1' WHERE ID_VOCE_DI_SPESA_MONIT= 1;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '2' WHERE ID_VOCE_DI_SPESA_MONIT= 2;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '3' WHERE ID_VOCE_DI_SPESA_MONIT= 3;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '4' WHERE ID_VOCE_DI_SPESA_MONIT= 4;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '5' WHERE ID_VOCE_DI_SPESA_MONIT= 5;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '6' WHERE ID_VOCE_DI_SPESA_MONIT= 6;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '99' WHERE ID_VOCE_DI_SPESA_MONIT= 7;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '7' WHERE ID_VOCE_DI_SPESA_MONIT= 8;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '8' WHERE ID_VOCE_DI_SPESA_MONIT= 9;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '9' WHERE ID_VOCE_DI_SPESA_MONIT= 10;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '10' WHERE ID_VOCE_DI_SPESA_MONIT= 11;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '11' WHERE ID_VOCE_DI_SPESA_MONIT= 12;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '12' WHERE ID_VOCE_DI_SPESA_MONIT= 13;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '13' WHERE ID_VOCE_DI_SPESA_MONIT= 14;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '98' WHERE ID_VOCE_DI_SPESA_MONIT= 15;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '14' WHERE ID_VOCE_DI_SPESA_MONIT= 16;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '15' WHERE ID_VOCE_DI_SPESA_MONIT= 17;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '16' WHERE ID_VOCE_DI_SPESA_MONIT= 18;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '17' WHERE ID_VOCE_DI_SPESA_MONIT= 19;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '18' WHERE ID_VOCE_DI_SPESA_MONIT= 20;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '19' WHERE ID_VOCE_DI_SPESA_MONIT= 21;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '0' WHERE ID_VOCE_DI_SPESA_MONIT= 22;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '2' WHERE ID_VOCE_DI_SPESA_MONIT= 23;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '2' WHERE ID_VOCE_DI_SPESA_MONIT= 24;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '3' WHERE ID_VOCE_DI_SPESA_MONIT= 25;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '0' WHERE ID_VOCE_DI_SPESA_MONIT= 26;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '1' WHERE ID_VOCE_DI_SPESA_MONIT= 27;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '2' WHERE ID_VOCE_DI_SPESA_MONIT= 28;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '3' WHERE ID_VOCE_DI_SPESA_MONIT= 29;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '4' WHERE ID_VOCE_DI_SPESA_MONIT= 30;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '5' WHERE ID_VOCE_DI_SPESA_MONIT= 31;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '6' WHERE ID_VOCE_DI_SPESA_MONIT= 32;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '7' WHERE ID_VOCE_DI_SPESA_MONIT= 33;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '8' WHERE ID_VOCE_DI_SPESA_MONIT= 34;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '9' WHERE ID_VOCE_DI_SPESA_MONIT= 35;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '10' WHERE ID_VOCE_DI_SPESA_MONIT= 36;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '11' WHERE ID_VOCE_DI_SPESA_MONIT= 37;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '12' WHERE ID_VOCE_DI_SPESA_MONIT= 38;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '13' WHERE ID_VOCE_DI_SPESA_MONIT= 39;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '0' WHERE ID_VOCE_DI_SPESA_MONIT= 40;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '1' WHERE ID_VOCE_DI_SPESA_MONIT= 41;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '2' WHERE ID_VOCE_DI_SPESA_MONIT= 42;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '3' WHERE ID_VOCE_DI_SPESA_MONIT= 43;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '4' WHERE ID_VOCE_DI_SPESA_MONIT= 44;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '5' WHERE ID_VOCE_DI_SPESA_MONIT= 45;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '6' WHERE ID_VOCE_DI_SPESA_MONIT= 46;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '7' WHERE ID_VOCE_DI_SPESA_MONIT= 47;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '8' WHERE ID_VOCE_DI_SPESA_MONIT= 48;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '9' WHERE ID_VOCE_DI_SPESA_MONIT= 49;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '10' WHERE ID_VOCE_DI_SPESA_MONIT= 50;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '31' WHERE ID_VOCE_DI_SPESA_MONIT= 51;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '41' WHERE ID_VOCE_DI_SPESA_MONIT= 52;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '0' WHERE ID_VOCE_DI_SPESA_MONIT= 53;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '1' WHERE ID_VOCE_DI_SPESA_MONIT= 54;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '2' WHERE ID_VOCE_DI_SPESA_MONIT= 55;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '3' WHERE ID_VOCE_DI_SPESA_MONIT= 56;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '4' WHERE ID_VOCE_DI_SPESA_MONIT= 57;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '5' WHERE ID_VOCE_DI_SPESA_MONIT= 58;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '6' WHERE ID_VOCE_DI_SPESA_MONIT= 59;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '7' WHERE ID_VOCE_DI_SPESA_MONIT= 60;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '8' WHERE ID_VOCE_DI_SPESA_MONIT= 61;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '0' WHERE ID_VOCE_DI_SPESA_MONIT= 62;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '1' WHERE ID_VOCE_DI_SPESA_MONIT= 63;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '2' WHERE ID_VOCE_DI_SPESA_MONIT= 64;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '3' WHERE ID_VOCE_DI_SPESA_MONIT= 65;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '4' WHERE ID_VOCE_DI_SPESA_MONIT= 66;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '5' WHERE ID_VOCE_DI_SPESA_MONIT= 67;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '6' WHERE ID_VOCE_DI_SPESA_MONIT= 68;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '7' WHERE ID_VOCE_DI_SPESA_MONIT= 69;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '8' WHERE ID_VOCE_DI_SPESA_MONIT= 70;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '0' WHERE ID_VOCE_DI_SPESA_MONIT= 71;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '1' WHERE ID_VOCE_DI_SPESA_MONIT= 72;
UPDATE PBANDI_D_VOCE_DI_SPESA_MONIT SET COD_IGRUE_T28 = '2' WHERE ID_VOCE_DI_SPESA_MONIT= 73;
COMMIT;
ALTER TABLE PBANDI_D_VOCE_DI_SPESA_MONIT MODIFY COD_IGRUE_T28 NOT NULL;
--

-- VISTE
CREATE OR REPLACE FORCE VIEW PBANDI_V_DOC_INDEX_BATCH_FINP
(
   ID_DOCUMENTO_INDEX,
   UUID_NODO,
   ID_PROGETTO,
   NOME_FILE,
   NOME_FILE_FIRMATO,
   TIPO_INVIO,
   FLAG_FIRMA_CARTACEA,
   FLAG_TRASM_DEST,
   ID_DICHIARAZIONE_SPESA,
   DESC_BREVE_TIPO_DOC_INDEX
)
AS
   WITH SF_INVIO
        AS (  SELECT                                
                    c.ID_DICHIARAZIONE_SPESA ID_TARGET,
                     c.ID_PROGETTO,
                     CASE
                        WHEN MIN (TIPO_INVIO) || MAX (TIPO_INVIO) = 'CC'
                        THEN
                           'C'
                        WHEN MIN (TIPO_INVIO) || MAX (TIPO_INVIO) = 'DD'
                        THEN
                           'E'
                        WHEN MIN (TIPO_INVIO) || MAX (TIPO_INVIO) = 'CD'
                        THEN
                           'I'
                        ELSE
                           NULL
                     END
                        TIPO_INVIO
                FROM PBANDI_S_DICH_DOC_SPESA a,
                     PBANDI_R_DOC_SPESA_PROGETTO b,
                     PBANDI_T_DICHIARAZIONE_SPESA c
               WHERE     a.ID_DICHIARAZIONE_SPESA = c.ID_DICHIARAZIONE_SPESA
                     AND a.ID_DOCUMENTO_DI_SPESA = b.ID_DOCUMENTO_DI_SPESA
                     AND b.ID_PROGETTO = c.ID_PROGETTO
            GROUP BY c.ID_DICHIARAZIONE_SPESA, c.ID_PROGETTO)
   SELECT ID_DOCUMENTO_INDEX,
          UUID_NODO,
          di.ID_PROGETTO,
          NOME_FILE,
          CASE
             WHEN FLAG_FIRMA_CARTACEA = 'N'
             THEN
                NOME_FILE
                || (SELECT valore
                      FROM PBANDI_C_COSTANTI
                     WHERE attributo = 'conf.firmaDigitaleFileExtension')
             ELSE
                NULL
          END
             NOME_FILE_FIRMATO,
          CASE
             WHEN en.NOME_ENTITA IN
                     ('PBANDI_T_DICHIARAZIONE_SPESA',
                      'PBANDI_T_COMUNICAZ_FINE_PROG')
             THEN
                i.TIPO_INVIO
             ELSE
                NULL                               --Comunicazione di rinuncia
          END
             TIPO_INVIO,
          FLAG_FIRMA_CARTACEA,
          NVL (FLAG_TRASM_DEST, 'N') FLAG_TRASM_DEST,
          --Dichiarazione di spesa(id_target di Id_entita 63 PBANDI_T_DICHIARAZIONE_SPESA)
          --Cumunicazione di fine progetto (id_entita 270  PBANDI_T_COMUNICAZ_FINE_PROG cercare la dichiarazione di spesa di tipo DESC_BREVE_TIPO_DICHIARA_SPESA=FC)
          --Comunicazione di rinuncia (id_entita 249 PBANDI_T_RINUNCIA id_dichiarazione di spesa=NULL
          CASE
             WHEN en.NOME_ENTITA = 'PBANDI_T_DICHIARAZIONE_SPESA'
             THEN
                di.ID_TARGET
             WHEN en.NOME_ENTITA = 'PBANDI_T_COMUNICAZ_FINE_PROG'
             THEN
                (SELECT MAX (id_dichiarazione_spesa)
                   FROM PBANDI_T_DICHIARAZIONE_SPESA dich
                  WHERE id_progetto = di.id_progetto
                        AND id_tipo_dichiaraz_spesa IN
                               (SELECT id_tipo_dichiaraz_spesa
                                  FROM PBANDI_D_TIPO_DICHIARAZ_SPESA
                                 WHERE DESC_BREVE_TIPO_DICHIARA_SPESA = 'FC')) -- Finale con comunicazione
             ELSE
                NULL                               --Comunicazione di rinuncia
          END
             ID_DICHIARAZIONE_SPESA,
          tdi.DESC_BREVE_TIPO_DOC_INDEX
     FROM PBANDI_T_DOCUMENTO_INDEX di
          JOIN PBANDI_C_TIPO_DOCUMENTO_INDEX tdi
             USING (ID_TIPO_DOCUMENTO_INDEX)
          JOIN PBANDI_C_ENTITA en
             USING (ID_ENTITA)
          LEFT JOIN PBANDI_D_STATO_DOCUMENTO_INDEX sdi
             USING (ID_STATO_DOCUMENTO)
          JOIN PBANDI_T_PROGETTO p
             ON p.ID_PROGETTO = di.ID_PROGETTO
          JOIN PBANDI_T_DOMANDA
             USING (ID_DOMANDA)
          JOIN PBANDI_R_BANDO_LINEA_INTERVENT bli
             USING (PROGR_BANDO_LINEA_INTERVENTO)
          JOIN PBANDI_R_BANDO_LINEA_ENTE_COMP blec
             USING (PROGR_BANDO_LINEA_INTERVENTO)
          JOIN PBANDI_D_RUOLO_ENTE_COMPETENZA rec
             USING (ID_RUOLO_ENTE_COMPETENZA)
          JOIN PBANDI_T_ENTE_COMPETENZA ec
             USING (ID_ENTE_COMPETENZA)
          LEFT JOIN SF_INVIO i
             ON (i.ID_TARGET = di.ID_TARGET
                 AND i.ID_PROGETTO = di.ID_PROGETTO)
    WHERE tdi.FLAG_FIRMABILE = 'S'
          AND en.NOME_ENTITA IN
                 ('PBANDI_T_DICHIARAZIONE_SPESA',
                  'PBANDI_T_COMUNICAZ_FINE_PROG',
                  'PBANDI_T_RINUNCIA')
          AND sdi.DESC_BREVE IN ('INVIATO')
          AND NVL (di.FLAG_FIRMA_CARTACEA, 'N') = 'N'
          AND di.DT_MARCA_TEMPORALE IS NOT NULL
          AND rec.DESC_BREVE_RUOLO_ENTE = 'DESTINATARIO'
          AND ec.DESC_BREVE_ENTE = 'FIN';

		  
		  
		  

--PBANDI_V_PROGETTI_BEN_BL		  
CREATE OR REPLACE FORCE VIEW PBANDI_V_PROGETTI_BEN_BL
(
   ID_PROGETTO,
   PROGR_BANDO_LINEA_INTERVENTO,
   NOME_BANDO_LINEA,
   CODICE_FISCALE_SOGGETTO,
   ID_SOGGETTO,
   CODICE_VISUALIZZATO_PROGETTO,
   TITOLO_PROGETTO,
   ID_SOGGETTO_BENEFICIARIO,
   CODICE_FISCALE_BENEFICIARIO,
   DENOMINAZIONE_BENEFICIARIO,
   FLAG_RAPPRESENTANTE_LEGALE,
   FLAG_PUBBLICO_PRIVATO,
   CODICE_RUOLO
)
AS
   SELECT                                       /*+NO_QUERY_TRANSFORMATION  */
         m.ID_PROGETTO,
          m.PROGR_BANDO_LINEA_INTERVENTO,
          m.NOME_BANDO_LINEA,
          m.CODICE_FISCALE_SOGGETTO,
          m.ID_SOGGETTO,
          m.CODICE_VISUALIZZATO_PROGETTO,
          m.TITOLO_PROGETTO,
          ben.id_soggetto_BENEFICIARIO,
          ben.codice_fiscale_BENEFICIARIO,
          ben.DENOMINAZIONE_BENEFICIARIO,
          CASE
             WHEN ben.id_soggetto_beneficiario IN
                     (SELECT rsc.id_soggetto_ente_giuridico
                        FROM pbandi_r_sogg_prog_sogg_correl rspsc,
                             pbandi_r_soggetti_correlati rsc,
                             pbandi_d_tipo_sogg_correlato dtsc
                       WHERE rsc.progr_soggetti_correlati =
                                rspsc.progr_soggetti_correlati
                             AND rspsc.progr_soggetto_progetto =
                                    m.progr_soggetto_progetto
                             AND rsc.id_tipo_soggetto_correlato =
                                    dtsc.id_tipo_soggetto_correlato
                             AND dtsc.desc_breve_tipo_sogg_correlato =
                                    'Rappr. Leg.'
                             AND NVL (TRUNC (rsc.dt_fine_validita),
                                      TRUNC (SYSDATE + 1)) > TRUNC (SYSDATE)
                             AND NVL (TRUNC (dtsc.dt_fine_validita),
                                      TRUNC (SYSDATE + 1)) > TRUNC (SYSDATE))
                  AND m.desc_breve_tipo_anagrafica = 'PERSONA-FISICA'
             THEN
                'S'
             ELSE
                'N'
          END
             flag_rappresentante_legale,
			 ben.flag_pubblico_privato,
			 m.codice_ruolo
     FROM (SELECT rsp.id_soggetto id_soggetto_beneficiario,
                  benInfo.codice_fiscale_soggetto codice_fiscale_beneficiario,
                  NVL (teg.denominazione_ente_giuridico,
                       tpf.nome || NVL2 (tpf.nome, ' ', '') || tpf.cognome)
                     AS denominazione_beneficiario,
					 teg.flag_pubblico_privato,
                  rsp.id_progetto
             FROM pbandi_r_soggetto_progetto rsp,
                  (SELECT pbandi_t_soggetto.id_soggetto,
                          pbandi_t_soggetto.codice_fiscale_soggetto,
                          pbandi_d_tipo_soggetto.desc_breve_tipo_soggetto
                     FROM pbandi_t_soggetto, pbandi_d_tipo_soggetto
                    WHERE NVL (
                             TRUNC (pbandi_d_tipo_soggetto.dt_fine_validita),
                             TRUNC (SYSDATE + 1)) > TRUNC (SYSDATE)
                          AND pbandi_d_tipo_soggetto.id_tipo_soggetto =
                                 pbandi_t_soggetto.id_tipo_soggetto) benInfo,
                  pbandi_t_ente_giuridico teg,
                  pbandi_t_persona_fisica tpf
            WHERE rsp.id_soggetto = benInfo.id_soggetto
                  AND rsp.ID_TIPO_ANAGRAFICA =
                         (SELECT m.id_tipo_anagrafica
                            FROM pbandi_d_tipo_anagrafica m
                           WHERE m.desc_breve_tipo_anagrafica =
                                    'BENEFICIARIO')
                  AND NVL (TRUNC (rsp.dt_fine_validita), TRUNC (SYSDATE + 1)) >
                         TRUNC (SYSDATE)
                  AND NVL (rsp.id_tipo_beneficiario, '-1') <>
                         (SELECT dtb.id_tipo_beneficiario
                            FROM pbandi_d_tipo_beneficiario dtb
                           WHERE dtb.desc_breve_tipo_beneficiario =
                                    'BEN-ASSOCIATO')
                  AND NVL (TRUNC (teg.dt_fine_validita), TRUNC (SYSDATE + 1)) >
                         TRUNC (SYSDATE)
                  AND NVL (TRUNC (tpf.dt_fine_validita), TRUNC (SYSDATE + 1)) >
                         TRUNC (SYSDATE)
                  AND rsp.ID_PERSONA_FISICA = tpf.ID_PERSONA_FISICA(+)
                  AND rsp.id_ente_giuridico = teg.id_ente_giuridico(+)) ben,
          (SELECT m1.*,
                  crp.codice_ruolo,
                  cdp.uuid_processo definizione_processo,
                  NULL AS dt_aggiornamento,
                  NULL AS dt_inserimento
             FROM pbandi_v_soggetto_progetto m1,
                  (SELECT crp.codice codice_ruolo,
                          rrta.id_tipo_anagrafica,
                          crp.id_definizione_processo
                     FROM pbandi_c_ruolo_di_processo crp,
                          pbandi_r_ruolo_tipo_anagrafica rrta
                    WHERE crp.id_ruolo_di_processo =
                             rrta.id_ruolo_di_processo) crp,
                  pbandi_c_definizione_processo cdp
            WHERE cdp.id_definizione_processo = crp.id_definizione_processo
                  AND m1.id_tipo_anagrafica = crp.id_tipo_anagrafica) m
    WHERE ben.id_progetto = m.id_progetto
          AND (m.desc_breve_tipo_anagrafica <> 'PERSONA-FISICA'
               OR ben.id_soggetto_beneficiario IN
                     (SELECT rsc.id_soggetto_ente_giuridico
                        FROM pbandi_r_sogg_prog_sogg_correl rspsc,
                             pbandi_r_soggetti_correlati rsc
                       WHERE rsc.progr_soggetti_correlati =
                                rspsc.progr_soggetti_correlati
                             AND NVL (TRUNC (rsc.dt_fine_validita),
                                      TRUNC (SYSDATE + 1)) > TRUNC (SYSDATE)
                             AND rspsc.progr_soggetto_progetto =
                                    m.progr_soggetto_progetto
                             AND rsc.id_tipo_soggetto_correlato IN
                                    (SELECT rrta.id_tipo_soggetto_correlato
                                       FROM pbandi_r_ruolo_tipo_anagrafica rrta
                                      WHERE rrta.id_tipo_anagrafica =
                                               m.id_tipo_anagrafica)));

--PBANDI_V_PERC_SOGG_FINANZIAT
CREATE OR REPLACE VIEW PBANDI_V_PERC_SOGG_FINANZIAT
(
   ID_PROGETTO,
   ID_TIPO_SOGG_FINANZIAT,
   ID_TIPO_OPERAZIONE,
   PERC_TIPO_SOGG_FINANZIATORE,
   TOT_QUOTA_SOGG_FINANZIAT,
   TOT_QUOTA_PROGETTO,
   TOT_OTHFIN_DA_RIPARTIRE,
   TOT_AMMESSO,
   NORMATIVA
)
AS
   WITH TAM
        AS (  SELECT rce.ID_CONTO_ECONOMICO,
                     t.ID_PROGETTO,
                     DECODE (SUM (NVL (rce.IMPORTO_AMMESSO_FINANZIAMENTO, 0)),
                             0, 1,
                             SUM (rce.IMPORTO_AMMESSO_FINANZIAMENTO)) -- Per evitare errore Zero Divide
                        TOT_AMMESSO
                FROM PBANDI_T_RIGO_CONTO_ECONOMICO rce,
                     PBANDI_T_CONTO_ECONOMICO ce,
                     PBANDI_T_PROGETTO t,
                     PBANDI_D_STATO_CONTO_ECONOMICO sce,
                     PBANDI_D_TIPOLOGIA_CONTO_ECON tce
               WHERE rce.ID_CONTO_ECONOMICO = ce.ID_CONTO_ECONOMICO
                     AND t.ID_DOMANDA = ce.ID_DOMANDA
                     AND ce.ID_STATO_CONTO_ECONOMICO =
                            sce.ID_STATO_CONTO_ECONOMICO
                     AND sce.ID_TIPOLOGIA_CONTO_ECONOMICO =
                            tce.ID_TIPOLOGIA_CONTO_ECONOMICO
                     AND tce.desc_breve_tipologia_conto_eco = 'MASTER'
                     AND rce.DT_FINE_VALIDITA IS NULL
                     AND ce.DT_FINE_VALIDITA IS NULL
            GROUP BY rce.ID_CONTO_ECONOMICO, t.ID_PROGETTO),
        TQP
        AS (  SELECT a.ID_PROGETTO,
                     DECODE (SUM (IMP_QUOTA_SOGG_FINANZIATORE),
                             0, 1,
                             SUM (IMP_QUOTA_SOGG_FINANZIATORE)) -- Per evitare errore Zero Divide
                        TOT_QUOTA_PROGETTO,
                     SUM (
                        CASE
                           WHEN (B.ID_TIPO_SOGG_FINANZIAT = 3
                                 AND d.ID_TIPO_OPERAZIONE = 3
                                 AND fn_linea_interv_radice (a.ID_PROGETTO) =
                                        'PAR-FAS')
                           THEN
                              IMP_QUOTA_SOGG_FINANZIATORE
                           ELSE
                              0
                        END)
                        TOT_OTHFIN_DA_RIPARTIRE -- Richiesta Ceragioli email 14/2/17 di Re
                FROM PBANDI_R_PROG_SOGG_FINANZIAT a,
                     PBANDI_D_SOGGETTO_FINANZIATORE b,
                     PBANDI_D_TIPO_SOGG_FINANZIAT c,
                     PBANDI_T_PROGETTO d
               WHERE a.ID_SOGGETTO_FINANZIATORE = b.ID_SOGGETTO_FINANZIATORE
                     AND d.id_progetto = a.ID_PROGETTO
                     AND c.ID_TIPO_SOGG_FINANZIAT = b.ID_TIPO_SOGG_FINANZIAT
                     AND (B.FLAG_CERTIFICAZIONE = 'S'
                          OR B.ID_TIPO_SOGG_FINANZIAT = 3)
                     AND SYSDATE BETWEEN NVL (C.DT_INIZIO_VALIDITA,
                                              SYSDATE - 1)
                                     AND NVL (C.DT_FINE_VALIDITA, SYSDATE + 1)
            GROUP BY a.ID_PROGETTO),
        TQS
        AS (  SELECT a.ID_PROGETTO,
                     b.ID_TIPO_SOGG_FINANZIAT,
                     SUM (IMP_QUOTA_SOGG_FINANZIATORE) TOT_QUOTA_SOGG_FINANZIAT
                FROM PBANDI_R_PROG_SOGG_FINANZIAT a,
                     PBANDI_D_SOGGETTO_FINANZIATORE b,
                     PBANDI_D_TIPO_SOGG_FINANZIAT c,
                     PBANDI_T_PROGETTO d
               WHERE a.ID_SOGGETTO_FINANZIATORE = b.ID_SOGGETTO_FINANZIATORE
                     AND d.id_progetto = a.ID_PROGETTO
                     AND c.ID_TIPO_SOGG_FINANZIAT = b.ID_TIPO_SOGG_FINANZIAT
                     AND (B.FLAG_CERTIFICAZIONE = 'S'
                          OR B.ID_TIPO_SOGG_FINANZIAT = 3)
                     AND SYSDATE BETWEEN NVL (C.DT_INIZIO_VALIDITA,
                                              SYSDATE - 1)
                                     AND NVL (C.DT_FINE_VALIDITA, SYSDATE + 1)
            GROUP BY a.ID_PROGETTO, b.ID_TIPO_SOGG_FINANZIAT)
   --MAIN
   SELECT a.ID_PROGETTO,
          ID_TIPO_SOGG_FINANZIAT,
          d.ID_TIPO_OPERAZIONE,
          ROUND (
             (a.TOT_QUOTA_SOGG_FINANZIAT * 100
              / DECODE ( (b.TOT_QUOTA_PROGETTO - TOT_OTHFIN_DA_RIPARTIRE),
                        0, 1,  -- Per evitare errore Zero Divide
                        (b.TOT_QUOTA_PROGETTO - TOT_OTHFIN_DA_RIPARTIRE))),
             2)
             PERC_TIPO_SOGG_FINANZIATORE,
          TOT_QUOTA_SOGG_FINANZIAT,
          TOT_QUOTA_PROGETTO,
          TOT_OTHFIN_DA_RIPARTIRE,
          TOT_AMMESSO,
          fn_linea_interv_radice (a.ID_PROGETTO) NORMATIVA
     FROM TQS a,
          TQP b,
          TAM c,
          PBANDI_T_PROGETTO d
    WHERE     a.ID_PROGETTO = b.ID_PROGETTO
          AND a.ID_PROGETTO = c.ID_PROGETTO
          AND d.id_progetto = a.ID_PROGETTO
          -- Richiesta Ceragioli email 14/2/17 di Re
          AND NOT (    ID_TIPO_OPERAZIONE = 3
                   AND ID_TIPO_SOGG_FINANZIAT = 3
                   AND fn_linea_interv_radice (a.ID_PROGETTO) = 'PAR-FAS');
