/*******************************************************************************
* Copyright Regione Piemonte - 2024
* SPDX-License-Identifier: EUPL-1.2
******************************************************************************/

-- Add new row
-- PBANDI_C_TIPO_DOCUMENTO_INDEX
Insert into PBANDI_C_TIPO_DOCUMENTO_INDEX 
(ID_TIPO_DOCUMENTO_INDEX, 
DESC_BREVE_TIPO_DOC_INDEX, 
DESC_TIPO_DOC_INDEX, 
FLAG_FIRMABILE, 
FLAG_UPLOADABLE)
Values 
(31, 
'ACTA', 
'DOCUMENTO PRESENTE SU ACTA DI CUI ABBIAMO IL RIFERIMENTO SU PBANDI', 
'', 
'' 
);



-- PBANDI_R_DOC_INDEX_TIPO_ANAG
insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (1, 0, 0, 31);

insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (2, 0, 0, 31);

insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (3, 0, 0, 31);

insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (4, 0, 0, 31);

insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (5, 0, 0, 31);

insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (10, 0, 0, 31);

insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (11, 0, 0, 31);

insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (14, 0, 0, 31);

insert into pbandi.PBANDI_R_DOC_INDEX_TIPO_ANAG (ID_TIPO_ANAGRAFICA, ID_UTENTE_INS, ID_UTENTE_AGG, ID_TIPO_DOCUMENTO_INDEX)
values (25, 0, 0, 31);

-- pbandi_c_costanti
insert into pbandi_c_costanti (ATTRIBUTO, VALORE)
values ('path_write_storage', '/pbstorage_online/');


-- Valorizzazione descrizione menù   
--PBANDI_D_PERMESSO
Insert into PBANDI_D_PERMESSO
   (ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DESC_MENU)
 Values
   (157, 'MENUNOTIF', 'Menu notifiche email', TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'Report via email');
Insert into PBANDI_D_PERMESSO
   (ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DESC_MENU)
 Values
   (158, 'MENURIL', 'Menu rilevazione e controlli', TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'Monitoraggio controlli');

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  116 as ID_PERMESSO,
  'TRSBKO025' as DESC_BREVE_PERMESSO,
  'Associazione permesso-ruoli' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Associazione permesso a ruolo' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  117 as ID_PERMESSO,
  'TRSBKO026' as DESC_BREVE_PERMESSO,
  'Associazione ruolo-permessi' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Associazione ruolo a permesso' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  11 as ID_PERMESSO,
  'MENUCERT' as DESC_BREVE_PERMESSO,
  'Voce di menu certtificazione' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Certificazione' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  66 as ID_PERMESSO,
  'TRSACC002' as DESC_BREVE_PERMESSO,
  'Scelta Beneficiario' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Cambia Beneficiario' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  68 as ID_PERMESSO,
  'TRSBKO002' as DESC_BREVE_PERMESSO,
  'Dettaglio istruttore' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Gestione associazione istruttore a progetti' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  71 as ID_PERMESSO,
  'TRSBKO005' as DESC_BREVE_PERMESSO,
  'Configurazione Bando' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Configurazione Bando' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  75 as ID_PERMESSO,
  'TRSBKO010' as DESC_BREVE_PERMESSO,
  'Ricerca documentazione progetto' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Documenti di progetto' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  76 as ID_PERMESSO,
  'TRSWKS001' as DESC_BREVE_PERMESSO,
  'Visione elenco processi' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Linee di finanziamento' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  78 as ID_PERMESSO,
  'TRSWKS003' as DESC_BREVE_PERMESSO,
  'Visione elenco attivita''' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Attività da svolgere' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  82 as ID_PERMESSO,
  'TRSBKO011' as DESC_BREVE_PERMESSO,
  'Dettaglio Utente' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Gestione utenti' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  92 as ID_PERMESSO,
  'OPEIRR001-1' as DESC_BREVE_PERMESSO,
  'Visibilita'' combo progetto/beneficiario' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Registro controlli' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  137 as ID_PERMESSO,
  'TRSBKO027' as DESC_BREVE_PERMESSO,
  'Gestione templates' as DESC_PERMESSO,
  TO_DATE('10/14/2011 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Gestione templates' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  140 as ID_PERMESSO,
  'TRSRENMAS01' as DESC_BREVE_PERMESSO,
  'Rendicontazione massiva' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Rendicontazione massiva' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  133 as ID_PERMESSO,
  'MENUBIL' as DESC_BREVE_PERMESSO,
  'Permesso temporaneo per nascondere attivita'' di bilancio fino al rilascio' as DESC_PERMESSO,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Bilancio' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  146 as ID_PERMESSO,
  'TRSCLA001' as DESC_BREVE_PERMESSO,
  'Accesso alla console dei log applicativi' as DESC_PERMESSO,
  TO_DATE('08/06/2013 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Console applicativa' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  147 as ID_PERMESSO,
  'VERSERV' as DESC_BREVE_PERMESSO,
  'Accesso alla console verifica servizi esterni' as DESC_PERMESSO,
  TO_DATE('08/06/2013 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Verifica servizi' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  150 as ID_PERMESSO,
  'MENUTRS' as DESC_BREVE_PERMESSO,
  'Menu trasferimenti' as DESC_PERMESSO,
  TO_DATE('06/30/2017 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Trasferimenti' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;

MERGE INTO PBANDI_D_PERMESSO A USING
 (SELECT
  156 as ID_PERMESSO,
  'OPEGECO001' as DESC_BREVE_PERMESSO,
  'Gestione Economie' as DESC_PERMESSO,
  TO_DATE('09/26/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'Gestione Economie FSC' as DESC_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, DESC_BREVE_PERMESSO, DESC_PERMESSO, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, 
  DESC_MENU)
VALUES (
  B.ID_PERMESSO, B.DESC_BREVE_PERMESSO, B.DESC_PERMESSO, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, 
  B.DESC_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DESC_BREVE_PERMESSO = B.DESC_BREVE_PERMESSO,
  A.DESC_PERMESSO = B.DESC_PERMESSO,
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.DESC_MENU = B.DESC_MENU;


-- Valorizzazione flag menù  
--PBANDI_R_PERMESSO_TIPO_ANAGRAF

Insert into PBANDI_R_PERMESSO_TIPO_ANAGRAF
   (ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, FLAG_MENU)
 Values
   (157, 2, TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'S');
Insert into PBANDI_R_PERMESSO_TIPO_ANAGRAF
   (ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, FLAG_MENU)
 Values
   (157, 3, TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'S');
Insert into PBANDI_R_PERMESSO_TIPO_ANAGRAF
   (ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, FLAG_MENU)
 Values
   (157, 4, TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'S');
Insert into PBANDI_R_PERMESSO_TIPO_ANAGRAF
   (ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, FLAG_MENU)
 Values
   (157, 5, TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'S');
Insert into PBANDI_R_PERMESSO_TIPO_ANAGRAF
   (ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, FLAG_MENU)
 Values
   (158, 11, TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'S');
Insert into PBANDI_R_PERMESSO_TIPO_ANAGRAF
   (ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, FLAG_MENU)
 Values
   (66, 8, TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 'S');

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  11 as ID_PERMESSO,
  6 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  11 as ID_PERMESSO,
  10 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  11 as ID_PERMESSO,
  21 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  11 as ID_PERMESSO,
  11 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  11 as ID_PERMESSO,
  4 as ID_TIPO_ANAGRAFICA,
  TO_DATE('06/03/2020 09:56:49', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  66 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  66 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('10/22/2017 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  68 as ID_PERMESSO,
  2 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  68 as ID_PERMESSO,
  4 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  71 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  71 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  3 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  2 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  25 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  18 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  19 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  24 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/08/2018 16:24:38', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  16 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  21 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  6 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  10 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  23 as ID_TIPO_ANAGRAFICA,
  TO_DATE('09/04/2013 12:03:04', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  11 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  5 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  75 as ID_PERMESSO,
  4 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  76 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  76 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  76 as ID_PERMESSO,
  20 as ID_TIPO_ANAGRAFICA,
  TO_DATE('02/11/2011 09:54:43', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  11 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  10 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  6 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  5 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  3 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  2 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  18 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  19 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  16 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  4 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  24 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/08/2018 16:24:38', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  25 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  23 as ID_TIPO_ANAGRAFICA,
  TO_DATE('09/04/2013 12:19:07', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  20 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  78 as ID_PERMESSO,
  21 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  82 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  82 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  82 as ID_PERMESSO,
  4 as ID_TIPO_ANAGRAFICA,
  TO_DATE('04/26/2012 14:44:10', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  92 as ID_PERMESSO,
  11 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  116 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  116 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  117 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  117 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  133 as ID_PERMESSO,
  2 as ID_TIPO_ANAGRAFICA,
  TO_DATE('02/27/2012 16:25:42', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  137 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('11/14/2011 16:58:07', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  137 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('10/14/2011 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;


MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  146 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('08/07/2013 09:04:13', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  146 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('08/07/2013 09:04:03', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  147 as ID_PERMESSO,
  14 as ID_TIPO_ANAGRAFICA,
  TO_DATE('08/21/2013 16:15:45', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  150 as ID_PERMESSO,
  3 as ID_TIPO_ANAGRAFICA,
  TO_DATE('06/30/2017 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  150 as ID_PERMESSO,
  11 as ID_TIPO_ANAGRAFICA,
  TO_DATE('06/30/2017 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  150 as ID_PERMESSO,
  2 as ID_TIPO_ANAGRAFICA,
  TO_DATE('06/30/2017 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  156 as ID_PERMESSO,
  8 as ID_TIPO_ANAGRAFICA,
  TO_DATE('09/26/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  156 as ID_PERMESSO,
  4 as ID_TIPO_ANAGRAFICA,
  TO_DATE('09/26/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  156 as ID_PERMESSO,
  2 as ID_TIPO_ANAGRAFICA,
  TO_DATE('09/26/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as DT_INIZIO_VALIDITA,
  NULL as DT_FINE_VALIDITA,
  'S' as FLAG_MENU
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;
/*
MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  157 as "ID_PERMESSO",
  2 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  157 as "ID_PERMESSO",
  3 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  157 as "ID_PERMESSO",
  4 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  157 as "ID_PERMESSO",
  5 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('01/01/2009 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  158 as "ID_PERMESSO",
  11 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('02/04/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  161 as "ID_PERMESSO",
  4 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('07/01/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  161 as "ID_PERMESSO",
  5 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('07/01/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  162 as "ID_PERMESSO",
  26 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('11/01/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  164 as "ID_PERMESSO",
  26 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('11/01/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  168 as "ID_PERMESSO",
  27 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('12/14/2021 18:14:29', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  183 as "ID_PERMESSO",
  4 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('12/16/2021 18:14:29', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

MERGE INTO PBANDI_R_PERMESSO_TIPO_ANAGRAF A USING
 (SELECT
  184 as "ID_PERMESSO",
  4 as "ID_TIPO_ANAGRAFICA",
  TO_DATE('01/10/2022 15:37:32', 'MM/DD/YYYY HH24:MI:SS') as "DT_INIZIO_VALIDITA",
  NULL as "DT_FINE_VALIDITA",
  'S' as "FLAG_MENU"
  FROM DUAL) B
ON (A.ID_PERMESSO = B.ID_PERMESSO and A.ID_TIPO_ANAGRAFICA = B.ID_TIPO_ANAGRAFICA)
WHEN NOT MATCHED THEN 
INSERT (
  ID_PERMESSO, ID_TIPO_ANAGRAFICA, DT_INIZIO_VALIDITA, DT_FINE_VALIDITA, FLAG_MENU)
VALUES (
  B.ID_PERMESSO, B.ID_TIPO_ANAGRAFICA, B.DT_INIZIO_VALIDITA, B.DT_FINE_VALIDITA, B.FLAG_MENU)
WHEN MATCHED THEN
UPDATE SET 
  A.DT_INIZIO_VALIDITA = B.DT_INIZIO_VALIDITA,
  A.DT_FINE_VALIDITA = B.DT_FINE_VALIDITA,
  A.FLAG_MENU = B.FLAG_MENU;

*/
COMMIT;



--Regole
Insert into PBANDI_C_REGOLA
   (ID_REGOLA, DESC_BREVE_REGOLA, DESC_REGOLA, DT_INIZIO_VALIDITA)
 Values
   (50, 'BR50', 'Consente l’invio digitale della dichiarazione di spesa con firma autografa (fatta a mano) in sostituzione della modalità “Invio Extra-Procedura”', TO_DATE('09/22/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'));
Insert into PBANDI_C_REGOLA
   (ID_REGOLA, DESC_BREVE_REGOLA, DESC_REGOLA, DT_INIZIO_VALIDITA)
 Values
   (51, 'BR51', 'In fase di Rendicontazione è previsto il caricamento di allegati ai documenti di spesa da parte del Beneficiario', TO_DATE('09/22/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'));
Insert into PBANDI_C_REGOLA
   (ID_REGOLA, DESC_BREVE_REGOLA, DESC_REGOLA, DT_INIZIO_VALIDITA)
 Values
   (52, 'BR52', 'In fase di Rendicontazione è previsto il caricamento di allegati alle quietanze da parte del Beneficiario', TO_DATE('09/22/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'));
Insert into PBANDI_C_REGOLA
   (ID_REGOLA, DESC_BREVE_REGOLA, DESC_REGOLA, DT_INIZIO_VALIDITA)
 Values
   (53, 'BR53', 'Permette di caricare degli allegati generici (facoltativi) alla dichiarazione di spesa', TO_DATE('09/22/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'));
Insert into PBANDI_C_REGOLA
   (ID_REGOLA, DESC_BREVE_REGOLA, DESC_REGOLA, DT_INIZIO_VALIDITA)
 Values
   (54, 'BR54', 'Consente di inserire esclusivamente la dichiarazione di spesa finale. Non presentare il radio button per la selezione del tipo di dichiarazione e impostare il tipo direttamente come FINALE', TO_DATE('09/22/2021 00:00:00', 'MM/DD/YYYY HH24:MI:SS'));
Insert into PBANDI_C_REGOLA
   (ID_REGOLA, DESC_BREVE_REGOLA, DESC_REGOLA, DT_INIZIO_VALIDITA)
 Values
   (55, 'BR55', 'Specifica se per il bando linea è previsto il caricamento della check-list documentale in fase di chiusura della validazione della dichiarazione di spesa', TO_DATE('01/14/2022 00:00:00', 'MM/DD/YYYY HH24:MI:SS'));
COMMIT;


/*
*** script da eseguire ad ogni rilascio
*/

update PBANDI_C_VERSIONE
set VERSIONE_DB = '3.26.0';

insert into PBANDI_C_ENTITA
(ID_ENTITA, NOME_ENTITA, FLAG_DA_TRACCIARE) 
(select seq_PBANDI_C_ENTITA.nextval,tabs.TABLE_NAME,'S'
from all_tables tabs
where tabs.OWNER = (select decode(instr(user,'_RW'),0,user,replace(user,'_RW',null)) from dual)
and tabs.TABLE_NAME like 'PBANDI_%'
and not exists (select 'x' from pbandi_c_entita where tabs.TABLE_NAME = NOME_ENTITA));

commit;

declare
  cursor curAttr is select col.COLUMN_NAME,en.id_ENTITA,col.TABLE_NAME
                    from all_tab_cols col,PBANDI_C_ENTITA en
                    where col.owner = (select decode(instr(user,'_RW'),0,user,replace(user,'_RW',null)) from dual)
                    and col.TABLE_NAME like 'PBANDI_%'
                    and col.COLUMN_NAME not like 'SYS_%'
                    and col.TABLE_NAME = en.NOME_ENTITA
                    and not exists (select 'x' from PBANDI_C_ATTRIBUTO att 
                                    where col.COLUMN_NAME = att.NOME_ATTRIBUTO
                                    and att.id_entita = en.id_ENTITA);
                                    
  nPosiz  PLS_INTEGER := NULL;                                                                          
begin
  for recAttr in curAttr loop

    BEGIN
      SELECT POSITION
      INTO   nPosiz 
      FROM   all_CONSTRAINTS A,all_CONS_COLUMNS B
      WHERE  A.CONSTRAINT_TYPE = 'P'
      AND    A.TABLE_NAME      = recAttr.TABLE_NAME
      AND    A.CONSTRAINT_NAME = B.CONSTRAINT_NAME
      AND    COLUMN_NAME       = recAttr.COLUMN_NAME;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        nPosiz := NULL;
    END;
    
    insert into PBANDI_C_ATTRIBUTO
    (ID_ATTRIBUTO, 
     NOME_ATTRIBUTO, 
     FLAG_DA_TRACCIARE, 
     ID_ENTITA,
     KEY_POSITION_ID) 
    values
    (SEQ_PBANDI_C_ATTRIBUTO.NEXTVAL,
     recAttr.COLUMN_NAME,
     'N',
     recAttr.id_ENTITA,
     nPosiz);
  end loop;
  COMMIT;
end;
/